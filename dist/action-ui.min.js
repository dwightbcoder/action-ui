"use strict";function _get(a,b,c){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=_superPropBase(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},_get(a,b,c||a)}function _superPropBase(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=_getPrototypeOf(a),null!==a););return a}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _createSuper(a){var b=_isNativeReflectConstruct();return function(){var c,d=_getPrototypeOf(a);if(b){var e=_getPrototypeOf(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _possibleConstructorReturn(a,b){if(b&&("object"===_typeof(b)||"function"==typeof b))return b;if(void 0!==b)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var ActionUI=function(a){'use strict';/**
	 * Utilities
	 */ // Recursively copy source properties to target (Warning: Classes are treated as Objects)
function b(a,c){var d=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];for(var e in d&&(c=Object.assign({},c)),c)c.hasOwnProperty(e)&&(d&&c[e]instanceof Object&&(c[e]=Object.assign({},c[e])),a.hasOwnProperty(e)?(d&&a[e]instanceof Object&&(a[e]=Object.assign({},a[e])),a[e]instanceof Object&&c[e]instanceof Object&&!(a[e]instanceof Function||c[e]instanceof Function)?b(a[e],c[e]):a[e]!=c[e]&&(a[e]=c[e])):a[e]=c[e]);return a;// For simpler dereference usage
}function c(a){return"FORM"==a.tagName?a:a.form}function d(a){return a[0].toUpperCase()+a.substr(1).toLowerCase()}function e(a){return a.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,function(a,b){return b.toUpperCase()})}function f(a,b){return null==a||a.matches(b)?a:f(a.parentElement,b)}function g(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return b=Object.assign(Object.fromEntries(new FormData(a)),b),Object.entries(b).map(function(a){var c=a[0].split("[").map(function(a){return a.replace(/]/g,"")});if(1<c.length){var d=h(c,a[1]);Util.deepAssign(b,d),delete b[a[0]]}return a}),b}function h(a,b,c){var d=a.pop();if(!d)return c;var e={};return e[d]=c?c:b,h(a,b,e)}var i=/*#__PURE__*/Object.freeze({__proto__:null,deepAssign:b,deepCopy:function(a,c){return b(a,c,!0)},requestFromElement:function(a){return new Request(a.action||options.href||null,{method:a.method||null})},form:c,capitalize:d,camelCase:e,firstMatchingParentElement:f,formToObject:g}),j=/*#__PURE__*/function(){//static __instance = 0
function a(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,a),this._options={triggerDelay:10},this._changes={},this._watchers=[],this._timer=null,this._parent=d,this._privatize(),b(this,c),this.sync(c);var f=function(b,c,d){var e=b[c];if(b[c]&&b[c]instanceof a)b[c].sync(d);else if(window.Reflect&&window.Reflect.set)d instanceof Object&&!(d instanceof a)&&"_"!=c[0]&&(d=new a(d,{model:b,property:c})),Reflect.set(b,c,d);else throw"Missing Model dependency: Reflect.set()";return"_"==c[0]||(b._change(c,d,e),!0)},g=function(a,b){if(b in a){var c=a[b];delete a[b],a._change(b,void 0,c)}return!0},h=null;try{h=new Proxy(this,{set:f,deleteProperty:g})}catch(a){h=new Proxy(this,{set:f})}return b(this,c),h}return _createClass(a,[{key:"clear",value:function clear(){for(var a in this)try{delete this[a]}catch(c){// Fallback for IE11
var b=this[a];this[a]=void 0,this._change(a,void 0,b)}return this}// Sync data object to model
},{key:"sync",value:function sync(a){return a=b({},a,!0),b(this,a),this}// Add watcher callback
},{key:"watch",value:function watch(a){return this._watchers.push(a),this}},{key:"clearChanges",value:function clearChanges(){return this._changes={},this}},{key:"triggerChanges",value:function triggerChanges(){return this._trigger(!0)}},{key:"_privatize",value:function _privatize(){for(var a in this)"_"==a[0]&&Object.defineProperty(this,a,{enumerable:!1})}// Trigger all watcher callbacks
},{key:"_trigger",value:function _trigger(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];if(window.clearTimeout(this._timer),this._timer=null,a||0<Object.keys(this._changes).length){var b=this._watchers;for(var c in b)b[c].call(this,this._changes);// Clear change list
this._changes={}}}// Log property change
},{key:"_change",value:function _change(a,c,d){var e=this;if(this._changes[a]={value:c,originalValue:d},this._timer||(this._timer=window.setTimeout(function(){return e._trigger()},this._options.triggerDelay)),null!=this._parent){var f={};f=b({},this,!0),f[a]=d,this._parent.model._change(this._parent.property,this,f)}}}]),a}(),k=/*#__PURE__*/function(){function a(b,c,d){_classCallCheck(this,a),this.name=b,this.handler=c||function(a,b,c){return a(c)},this.model=d?d:new j,this.running=!1,m.autoCache&&a.cache(this)}// trigger before event and run the handler as a promise 
return _createClass(a,[{key:"run",value:function run(b){var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};m.verbose&&console.info("Action.run()",this.name,{action:this,target:b,data:d}),this.running=!0,b=b||document.body,d=Object.assign(d,a.data(b)),this.before(b,d);var e=null;if(this.handler instanceof Function)e=new Promise(function(a,b){return c.handler(a,b,d)});else if(this.handler instanceof Request){// If there is data to send, recreate the request with the data
if(0<Object.keys(d).length){var f={};for(var g in this.handler)f[g]=this.handler[g];if("POST"!=f.method)"GET"==f.method&&(// Append query string to URL with ?/& first as needed
f.url+=(0>f.url.indexOf("?")?"?":"&")+Object.keys(d).map(function(a){return a+"="+d[a]}).join("&"));else if(b.attributes.enctype&&"application/json"==b.attributes.enctype.value)f.body=JSON.stringify(d);else{var h=new FormData;for(var i in d)h.append(i,d[i]);f.body=h}this.handler=new Request(f.url,f)}e=fetch(this.handler).then(function(a){return a.json()})}return e.then(function(a){return c.after(b,!0,a,d)},function(a){return c.after(b,!1,a,d)})}},{key:"syncModel",value:function syncModel(a){return a=b({},a,!0),m.verbose&&console.info("Action.syncModel()",this.name,{action:this,data:a}),a instanceof Object||(a={result:a}),this.model.sync&&this.model.sync instanceof Function?this.model.sync(a):this.model instanceof Object&&b(this.model,a),a}},{key:"before",value:function before(b,c){m.verbose&&console.info("Action.before()",this.name,{action:this,target:b,data:c}),a.setCssClass(b,m.cssClass.loading),a.reflectCssClass(this.name,m.cssClass.loading),Object.assign(m.eventBefore.detail,{name:this.name,data:c,model:this.model}),b.dispatchEvent(m.eventBefore)}},{key:"after",value:function after(b,c,d,e){m.verbose&&console.info("Action.after()",this.name,{action:this,target:b,data:e,success:c,result:d}),this.running=!1;//target.removeAttribute('disabled')
var f=c?m.cssClass.success:m.cssClass.fail;return a.setCssClass(b,f),a.reflectCssClass(this.name,f),null!=d&&this.syncModel(d),Object.assign(m.eventAfter.detail,{name:this.name,success:c,data:e,model:this.model}),b.dispatchEvent(m.eventAfter),d}// #region Static methods
// Initialize the action cache and top-level event listener (only once)
}],[{key:"init",value:function init(){document.addEventListener("click",function(b){var c=f(b.target,"[ui-action]");if(c&&"FORM"!=c.tagName){"INPUT"==c.tagName&&("checkbox"==c.type||"radio"==c.type)||b.preventDefault();var d=c.getAttribute("ui-action");// Don't run the action if it's already running
if(d in l)!1==l[d].running&&l[d].run(c);else if(m.autoCreate){// Auto create and run action
var e=a.createFromElement(c);a.cache(e),e.run(c)}else throw new Error("Action not found: "+d)}}),document.addEventListener("submit",function(b){if(b.target.matches("form[ui-action]")){b.preventDefault();var c=b.target.getAttribute("ui-action");// Don't run the action if it's already running
if(c in l)!1==l[c].running&&l[c].run(b.target);else if(m.autoCreate){// Auto create and run action
var d=a.createFromElement(b.target);a.cache(d),d.run(b.target)}else throw new Error("Action not found: "+c)}})}},{key:"create",value:function create(b){if(!1=="name"in b)throw"No action name specfied";return!1=="handler"in b&&(!0=="url"in b&&b.url?b.handler=new Request(b.url,b.request||{}):b.handler=null),new a(b.name,b.handler,b.model)}},{key:"createFromElement",value:function createFromElement(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return a.create(Object.assign({name:b.getAttribute("ui-action")||null,url:b.action||b.href||c.href||null,request:{method:b.method||c.method||"GET"}},c))}// Cache an action 
},{key:"cache",value:function cache(a){return null==a?l:"string"==typeof a?l[a]:a.name in l?this:(l[a.name]=a,this)}},{key:"data",value:function(a){var b=a.dataset||{},d=c(a);return d&&(b=g(d,b)),b}},{key:"get",value:function get(a){return l[a]}},{key:"setCssClass",value:function setCssClass(a,b){for(var c in m.cssClass)a.classList.remove(m.cssClass[c]);a.classList.add(b)}// Propagate class to all reflectors (ui-state and form submit buttons)
},{key:"reflectCssClass",value:function reflectCssClass(b,c){document.querySelectorAll("form[ui-action=\""+b+"\"] [type=\"submit\"], form[ui-action=\""+b+"\"] button:not([type]), [ui-state=\""+b+"\"]").forEach(function(b){return a.setCssClass(b,c)})}},{key:"options",get:function get(){return m},set:function set(a){b(m,a)}// #endregion
}]),a}(),l={},m={verbose:!1,autoCreate:!0,autoCache:!0,cssClass:{loading:"loading",success:"success",fail:"fail"},eventBefore:new CustomEvent("action.before",{bubbles:!0,detail:{type:"before",name:null,data:null,model:null}}),eventAfter:new CustomEvent("action.after",{bubbles:!0,detail:{type:"after",name:null,data:null,success:null,model:null}})};/**
	 * Model
	 * @description Observable data object
	 */k.init();/**
	 * Controller
	 * Provider route mapping for SPAs
	 */var n=/*#__PURE__*/function(){function a(b){_classCallCheck(this,a),this.view=b}return _createClass(a,[{key:"__autoload",value:function __autoload(){return this.view.render()}},{key:"__error",value:function __error(){return this.view.render()}},{key:"view",get:function get(){return this._view},set:function set(a){this._view=a}}]),a}(),o=/*#__PURE__*/function(a){function c(a,b){var e;// Accept an array of store keys
if(_classCallCheck(this,c),b instanceof Array){// Turn them into seperate stores
var f=b;for(var g in b=new j,f)b[f[g]]=new j}return b._paging={},e=d.call(this,b),e.baseUrl=a,e}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"sync",value:function sync(a){if(!a.hasOwnProperty("data"))throw new Error("JsonApi: No data to sync");if(a.data instanceof Array){var e={};for(var f in a.data)e[a.data[f].id]=this.sync({data:a.data[f]});return e;//this[json.data[0].type]
}var c=a.data.type,d=a.data.id;return this[c]||(this[c]=new j),this[c][d]||(this[c][d]=new j),b(this[c][d],a.data),this[c][d]}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a,b){var c=this;if(this[a]){if(null!=b&&this[a][b])return Promise.resolve(this[a][b]);if(null==b)return Promise.resolve(this[a])}return fetch(this.baseUrl+"/"+a+(b?"/"+b:"")).then(function(a){return a.json()}).then(function(a){return c.sync(a)})})},{key:"page",value:function page(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(d=parseInt(d)||0,c=parseInt(c)||1,a in this._paging&&d in this._paging[a]&&c in this._paging[a][d])return Promise.resolve().then(function(){return b._paging[a][d][c]});a in this._paging||(this._paging[a]={}),d in this._paging[a]||(this._paging[a][d]={}),c in this._paging[a][d]||(this._paging[a][d][c]=new j({type:a,number:c,size:d,count:0,links:{},model:new j}));var e="?page[number]="+c;return 0<d&&(e+="&page[size]="+d),fetch(this.baseUrl+"/"+a+e).then(function(a){return a.json()}).then(function(e){return b._paging[a][d][c].sync({links:e.links||{},count:Object.keys(e.data).length,model:b.sync(e)})})}},{key:"post",value:function post(){/*
	        data = {
	            id: '1',
	            attributes: {}
	        }
	        */}}]),c}(j),p=/*#__PURE__*/function(){function a(c){// Accept an array of store keys
if(_classCallCheck(this,a),this.options={baseUrl:null,types:null,keys:{data:null,type:"type",id:"id"},per_page:0,query:{"page[number]":"page[number]","page[size]":"page[size]"},fetch:{method:"GET",headers:new Headers({"Content-Type":"application/json"}),mode:"no-cors"},triggerChangesOnError:!0,// Allows views to update contents on failed requests, especially useful for Fetch All requests which return no results or 404
verbose:!1,viewClass:null,viewMap:{},actionVerb:{get:"fetch",post:"create",patch:"update",delete:"delete"},actionHandler:{get:function get(a,b,c,d,e){this.fetch(a,e.id).then(function(a){return c(a)}).catch(function(a){return a.json().then(function(a){return d(a)})})},post:function post(a,b,c,d,e){this.post(a,e).then(function(a){return c(a)}).catch(function(a){return a.json().then(function(a){return d(a)})})},patch:function patch(a,b,c,d,e){this.patch(a,e).then(function(a){return c(a)}).catch(function(a){return a.json().then(function(a){return d(a)})})},delete:function _delete(a,b,c,d,e){this.delete(a,e.id).then(function(a){return c(a)}).catch(function(a){return a.json().then(function(a){return d(a)})})}}},b(this.options,c||{}),this._model=new j,this._model._paging={},this.options.types instanceof Array){var d={};// Turn them into seperate stores
for(var e in this.options.types)d[this.options.types[e]]=this.options.types[e];this.options.types=d}if(this.options.types instanceof Object)for(var f in this.options.types)this.modelCreate(this.options.types[f]);a.cache(this)}return _createClass(a,[{key:"body",value:function body(a){return JSON.stringify(a)}},{key:"model",value:function model(a){return this._model[a]}},{key:"modelCreate",value:function modelCreate(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("string"!=typeof a)throw new Error("Store: Cannot create model without `type`");this._model[a]||(this._model[a]=new j({},{model:this._model,property:a}),this.actionCreate(a,"get"),this.actionCreate(a,"post"),this.actionCreate(a,"patch"),this.actionCreate(a,"delete"),this.options.viewClass&&this.options.viewMap.hasOwnProperty(a)&&new this.options.viewClass(this.options.viewMap[a],this._model[a])),null==b||"string"!=typeof b||this._model[a][b]||(this._model[a][b]=new j({},{model:this._model[a],property:b}))}},{key:"actionCreate",value:function actionCreate(a,b){b=b.toLowerCase();var c=a+" "+this.options.actionVerb[b],d=this.options.actionHandler[b].bind(this,a,b),e=new k(c,d);return k.cache(e),e}},{key:"data",value:function data(a){return this.options.keys.data?a[this.options.keys.data]:a}},{key:"type",value:function(a){var b=a[this.options.keys.type];return this.options.types[b]&&(b=this.options.types[b]),b}},{key:"id",value:function id(a){return a[this.options.keys.id]}},{key:"sync",value:function sync(a,b){var c=this.data(a);if(!c)throw new Error("Store: No data to sync");if(c instanceof Array){var f={};for(var g in c){var h=null;this.options.keys.data?(h={},h[this.options.keys.data]=c[g]):h=c[g],f[this.id(c[g])]=this.sync(h,b)}return f}var d=this.type(c),e=this.id(c);return this._model[d]||this.modelCreate(d),this._model[d][e]||this.modelCreate(d,e),this._model[d][e].sync(c),b&&(!this._model[d][e].hasOwnProperty("_store")&&(this._model[d][e]._store={url:[]}),-1==this._model[d][e]._store.url.indexOf(b)&&this._model[d][e]._store.url.push(b),b=this.url({type:d,id:e}),-1==this._model[d][e]._store.url.indexOf(b)&&this._model[d][e]._store.url.push(b)),this._model[d][e]}},{key:"url",value:function(a){var b=this.options.types[a.type]||a.type,c=this.options.baseUrl+"/"+b+"/"+(a.id?a.id+"/":""),d=new URLSearchParams;for(var f in a)f in this.options.query?d.set(this.options.query[f],a[f]):"type"!=f&&"id"!=f&&d.set(f,a[f]);var e=d.toString();return e&&(c+="?"+e),c}},{key:"search",value:function search(a){var b=new j;for(var e in this._model)if(!("_paging"==e||a.type&&this.type({type:a.type})!=e))for(var f in this._model[e]){var c=!0,d=this.data(this._model[e][f]);for(var g in a)if("type"!=g&&(!d.hasOwnProperty(g)||d[g]!=a[g])){c=!1;break}c&&(b[f]=d)}return b}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a,b){var c=this,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};a=this.type({type:a}),"object"==_typeof(b)&&(d=b,b=d.id),Object.assign(d,{type:a,id:b});var e=this.url(d);if(this._model[a]){if(null!=b&&this._model[a][b]&&!(this._model[a][b].hasOwnProperty("_store")&&-1==this._model[a][b]._store.url.indexOf(e)))return Promise.resolve(this._model[a][b]);if(null==b&&0==Object.keys(d).length)return Promise.resolve(this._model[a]);if(null==b){var f=this.search(d);if(Object.keys(f).length)return Promise.resolve(f)}}return fetch(e,this.options.fetch).then(function(a){return a.ok?a.json():Promise.reject(a)}).then(function(a){return c.sync(a,e)}).catch(function(b){return c.options.triggerChangesOnError&&c.model(a).triggerChanges(),Promise.reject(b)})})},{key:"page",value:function page(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;d=parseInt(d)||this.options.per_page,c=parseInt(c)||1;var e=this._model._paging;if(a in e&&d in e[a]&&c in e[a][d])return Promise.resolve().then(function(){return e[a][d][c]});a in e||(e[a]={}),d in e[a]||(e[a][d]={}),c in e[a][d]||(e[a][d][c]=new j({type:a,number:c,size:d,count:0,links:{},model:new j}));var f=this.url({type:a,"page[number]":c,"page[size]":d});return fetch(f,this.options.fetch).then(function(a){return a.ok?a.json():Promise.reject(a)}).then(function(f){return e[a][d][c].sync({links:f.links||{},count:Object.keys(b.data(f)).length,model:b.sync(f)})})}},{key:"post",value:function post(a,b){var c=this,d=Object.create(this.options.fetch);d.method="POST",a=a||this.type(b);var e=this.url({type:a,id:this.id(b)});return fetch(e,d).then(function(a){return a.json()}).then(function(a){return c.sync(a)})}},{key:"patch",value:function patch(a,b){var c=this,d=Object.create(this.options.fetch);d.method="PATCH",d.body=this.body(b),a=a||this.type(b);var e=this.url({type:a,id:this.id(b)});return fetch(e,d).then(function(a){return a.json()}).then(function(a){return c.sync(a)})}},{key:"delete",value:function _delete(a,b){var c=this,d=Object.create(this.options.fetch);d.method="DELETE";var e=this.url({type:a,id:b});return this.options.verbose&&console.info("Store.delete()",a,b,{store:this,url:e,options:d}),fetch(e,d).then(function(a){return a.ok?a.json():Promise.reject(a)}).then(function(d){return delete c._model[a][b],d})}}],[{key:"cache",value:function cache(a){if(null==a)return q;if("string"==typeof a){if(a=a.toLowerCase(),null!=q[a])return q[a];// Find a store that starts with the requested url to match ('/api/v1/entity' with a '/api/v1' store)
for(var b in q)if(b.startsWith(a))return q[b];return}var c=a.options.baseUrl.toLowerCase();return c in q?this:(q[c]=a,this)}}]),a}(),q={},r=/*#__PURE__*/function(a){function c(a){_classCallCheck(this,c);var e={keys:{data:"data",type:"type",id:"id"},query:{"page[number]":"page[number]","page[size]":"page[size]"},per_page:0,fetch:{headers:new Headers({"Content-Type":"application/vnd.api+json"})}};return b(e,a||{}),d.call(this,e)}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"sync",value:function sync(a,b){if(a.included){var d=this.options.keys.data;this.options.keys.data="included",_get(_getPrototypeOf(c.prototype),"sync",this).call(this,a,b),this.options.keys.data=d}return _get(_getPrototypeOf(c.prototype),"sync",this).call(this,a,b)}},{key:"body",value:function body(a){return JSON.stringify({data:a})}}]),c}(p),s=/*#__PURE__*/function(a){function c(a){_classCallCheck(this,c);var e={baseUrl:"/wp-json/wp/v2",types:{page:"pages",post:"posts",category:"categories",tag:"tags",comment:"comments"},keys:{data:null,type:"type",id:"id"},query:{"page[number]":"page","page[size]":"per_page"},per_page:10};return b(e,a||{}),d.call(this,e)}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"fetch",value:function fetch(a,b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return"string"==typeof b&&(d.slug=b,b=void 0),_get(_getPrototypeOf(c.prototype),"fetch",this).call(this,a,b,d)}}]),c}(p),t=/*#__PURE__*/function(){function a(b,c,d){var e=this;_classCallCheck(this,a),d instanceof j||(d=new j(d||{controller:null,data:{},dev:!1,error:null,method:null,path:null,view:null})),this._name=b,this._html=c,this._model=d,d.watch(function(a){return e.update(a)}),this.constructor.options.autoCache&&a.cache(this)}return _createClass(a,[{key:"clear",value:function clear(){return document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(a){a.innerHTML=""}),this}// When the model updates
},{key:"update",value:function update(a){this.constructor.options.verbose&&console.info(this.constructor.name+".update()",this.name,{view:this,changes:a}),this.render()}// Render the model data into the view template for all elements with [ui-view=this.name]
/**
	     * Render view to all matching containers
	     * @returns Promise
	     */},{key:"render",value:function render(){var a=this;return this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this}),document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(b){b.innerHTML=a.html,a.renderSubviews(b)}),Object.assign(this.constructor.options.eventRender.detail,{view:this}),document.dispatchEvent(this.constructor.options.eventRender),Promise.resolve()}},{key:"renderSubviews",value:function renderSubviews(a){var b=this;this.constructor.options.verbose&&console.info(this.constructor.name+".renderSubviews()",this.name,{view:this,parent:a}),a.querySelectorAll("[ui-view]").forEach(function(a){var c=a.getAttribute("ui-view"),d=b.constructor.cache(c);d&&d.render()})}},{key:"name",get:function get(){return this._name}},{key:"html",get:function get(){return this._html instanceof Function?this._html(this._model):this._html},set:function set(a){this._html=a}},{key:"model",get:function get(){return this._model}// #region Static methods
// View factory
}],[{key:"create",value:function create(a){return this.options.verbose&&console.info(this.name+":create()",{options:a}),new this(a.name,a.html,a.model)}// Cache a view 
},{key:"cache",value:function cache(b){if(this.options.verbose&&console.info(this.name+":cache()",{view:b}),"string"==typeof b)return u[b];if(b instanceof a){if(b.name in u)throw"View name already exists: \""+b.name+"\"";return u[b.name]=b,this}return u}// Render all views
},{key:"options",get:function get(){return v},set:function set(a){b(v,a)}// #endregion
}]),a}(),u={},v={verbose:!1,autoCache:!0,// Automatically cache views when created
eventRender:new CustomEvent("view.render",{bubbles:!0,detail:{type:"render",view:null}})},w=/*#__PURE__*/function(a){function c(a,b,e){var f;return _classCallCheck(this,c),2==arguments.length&&(e=b,b=void 0),b||(b=a),f=d.call(this,a,null,e),f.file=b,f}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"clear",value:function clear(){return this.html=null,_get(_getPrototypeOf(c.prototype),"clear",this).call(this)}},{key:"render",value:function render(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this});var b=null==this._html?this.fetch():Promise.resolve();return b.then(function(){return _get(_getPrototypeOf(c.prototype),"render",a).call(a)})}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(){var a=this;return this.constructor.options.verbose&&console.info(this.constructor.name+".fetch()",this.name,{view:this}),fetch(this.fullPath).then(function(a){if(a.ok)return a.text();throw new Error(a.statusText)}).then(function(b){return a._html=b}).catch(function(){throw new Error("File not found: "+a.fileName)})})},{key:"fileName",get:function get(){return this.file+"."+this.constructor.options.extension}},{key:"fullPath",get:function get(){return this.constructor.options.basePath+this.fileName}},{key:"file",get:function get(){return this._file},set:function set(a){a!=this._file&&(this._html=null),this._file=a}// #region Static methods
// View factory
}],[{key:"create",value:function create(a){return this.options.verbose&&console.info(this.name+":create()",{options:a}),a.file&&(a.file=a.name),new this(a.name,a.file,a.model)}},{key:"options",get:function get(){return x},set:function set(a){b(x,a)}// #endregion
}]),c}(t),x={basePath:"view/",extension:"html"};/**
	 * JsonApi
	 * @description Json API data store
	 * @tutorial var store = new JsonApi('http://localhost:8080/api', ['category', 'product'])
	 */w.options=t.options;/**
	 * ViewHandlebars
	 * @description View that uses Handlebars templates instead of html
	 * @update Support for pre-compiled templates
	 */var y=/*#__PURE__*/function(a){function c(){return _classCallCheck(this,c),d.apply(this,arguments)}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"render",value:function render(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this});var b=b=Promise.resolve();return null==this.html&&Handlebars.templates&&Handlebars.templates[this.file]&&(this.html=Handlebars.templates[this.file]),b.then(function(){return _get(_getPrototypeOf(c.prototype),"render",a).call(a)})}},{key:"fetch",value:function fetch(){var a=this;return _get(_getPrototypeOf(c.prototype),"fetch",this).call(this).then(function(b){return"templates"in Handlebars||(Handlebars.templates=[]),Handlebars.templates[a.file]=Handlebars.compile(b),a.html=Handlebars.templates[a.file],b})}// #region Static methods
}],[{key:"options",get:function get(){return z},set:function set(a){b(z,a)}// #endregion
}]),c}(w),z={};y.options=w.options,y.options.extension="hbs";var A=/*#__PURE__*/function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"start",value:function start(){window.addEventListener("popstate",this.onPopState.bind(this)),C.interceptLinks&&document.addEventListener("click",this.onClick.bind(this)),this.navigate(location.pathname)}},{key:"route",value:function route(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.options.routes[a]={route:a,callback:b,priority:c}}},{key:"match",value:function match(a){var b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];// Exact match
if(this.options.routes[a])return b&&"string"==typeof this.options.routes[a].callback?this.match(this.options.routes[a].callback):this.options.routes[a];var c=null;for(var d in Object.keys(this.options.routes))null!=a.match(d)&&(null==c||this.options.routes[d].priority<=c.priority)&&(c=this.options.routes[d]);// If route is a forward
return c&&b&&"string"==typeof c.callback&&(c=this.match(c.callback)),c}},{key:"navigate",value:function navigate(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;C.verbose&&console.info("Router.navigate()",{router:this,route:a,data:c});var f=this.sanitizePath(a),g=f[0],h=f[1],i=this.controllerName(g),j={data:c},l=this.match(a,!1);if(l&&"string"==typeof l.callback)// Redirect
return this.navigate(l.callback,c,d);this.controllers[i]||(g=C.defaultController,i=this.controllerName(g),h="/"==a?C.defaultMethod:f[0]),B[i]||(this.controllers[i]?B[i]=new this.controllers[i](this.view):B[i]=new n(this.view)),h=h||C.defaultMethod;var m=null,o=g+C.pathSeparator+h,p=e(h);B[i].view instanceof w?B[i].view.file=o:B[i].view instanceof y&&(B[i].view.html=o),C.autoload&&!(B[i][p]instanceof Function)&&(p=C.autoloadMethod),j.dev=location.host==C.devHost,j.view=o,j.controller=g,j.method=h,j.path=Array.from(f),j.event=d;// Query string to object
var q=location.search.substring(1);q&&(q=JSON.parse("{\""+decodeURI(q).replace(/"/g,"\\\"").replace(/&/g,"\",\"").replace(/=/g,"\":\"")+"\"}"),j.search=q);try{var r=Array.from(f);if(r.shift(),r.shift(),r.push(q),r.push(c),!l)B[i].view.model.clear().sync(j).clearChanges(),m=B[i][p].apply(B[i],r),this.pushState(a,{controller:g,method:h,data:Object.assign({},c),search:q});else if(l.callback instanceof k){l.callback.model.clear().sync(j).clearChanges();var s=d?d.target:document;m=l.callback.run(s,c)}else r.push(j),m=l.callback.apply(B[i],r)}catch(b){this.options.verbose&&console.error("Routing Error",b),this.pushState(a,{controller:g,method:h,data:Object.assign({},c),search:q}),m=this.handleError(i,j,f)}if(m instanceof Promise){var t=document.querySelectorAll("[ui-view=\""+this.view.name+"\"]");this.handleLoading(t,!0),m.then(function(){return b.handleLoading(t,!1)}).catch(function(a){throw b.handleLoading(t,!1),b.handleError(i,j,f,a),a})}return m}},{key:"handleLoading",value:function handleLoading(a,b){return b?a.forEach(function(a){return a.classList.add(C.cssClass.loading)}):a.forEach(function(a){return a.classList.remove(C.cssClass.loading)}),this}},{key:"handleError",value:function handleError(a,b,c,d){return b.error=d,b.view=b.controller+C.pathSeparator+C.errorView,b.path=c.join(C.pathSeparator),B[a].view instanceof w?B[a].view.file=(C.useControllerErrorViews?b.controller+C.pathSeparator:"")+C.errorView:B[a].view.html="Error loading "+b.path,B[a].view.model.clear().sync(b).clearChanges(),B[a][C.errorMethod]()}},{key:"sanitizePath",value:function sanitizePath(a){for(var b in C.verbose&&console.info("Router.sanitizePath()",{router:this,path:a}),"string"==typeof a&&(a=a.split("/"),a.shift(),a[0]=a[0]||C.defaultController),a)a[b]=(a[b]+"").toLowerCase();return 1==a.length&&a.push(C.defaultMethod),a}},{key:"controllerName",value:function controllerName(a){return C.verbose&&console.info("Router.controllerName()",{router:this,name:a}),d(e(a))+"Controller"}},{key:"pushState",value:function pushState(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};location.pathname!=a&&(c.route=a,b(this.state,c),history.pushState(this.state,null,a))}},{key:"onClick",value:function onClick(a){"A"==a.target.tagName&&a.target.pathname&&(a.preventDefault(),this.navigate(a.target.pathname,Object.assign({},a.target.dataset),a))}},{key:"onPopState",value:function onPopState(a){C.verbose&&console.info("Router.changeState()",{router:this,event:a});var b=location.pathname,c={};a.state&&(b=a.state.route,c=a.state.data),this.navigate(b,c)}// #region Properties
},{key:"controllers",get:function get(){return this.options.controllers},set:function set(a){this.options.controllers=a}},{key:"state",get:function get(){return this.options.state},set:function set(a){this.options.state=a}},{key:"view",get:function get(){return this.options.view instanceof t||(this.view=this.options.view),this.options.view},set:function set(a){this.options.view=a instanceof t?a:new w(a)}},{key:"options",get:function get(){return C},set:function set(a){b(C,a)}// #endregion
}]),a}(),B={},C={controllers:{},view:"controller",state:{},autoload:!0,verbose:!1,cssClass:{loading:"loading",success:"success",fail:"fail"},defaultController:"default",autoloadMethod:"__autoload",defaultMethod:"index",errorMethod:"__error",errorView:"error",useControllerErrorViews:!1,devHost:"localhost",interceptLinks:!0,pathSeparator:"/",routes:{}};return a.Action=k,a.Controller=n,a.JsonApi=o,a.Model=j,a.Router=A,a.Store=p,a.StoreJsonApi=r,a.StoreWordpress=s,a.Util=i,a.View=t,a.ViewFile=w,a.ViewHandlebars=y,a}({});