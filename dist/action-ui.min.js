"use strict";function _get(a,b,c){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=_superPropBase(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},_get(a,b,c||a)}function _superPropBase(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=_getPrototypeOf(a),null!==a););return a}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _possibleConstructorReturn(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:_assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var ActionUI=function(a){'use strict';/**
     * Utilities
     */function b(a,c){for(var d in c)c.hasOwnProperty(d)&&(a.hasOwnProperty(d)?a[d]instanceof Object&&c[d]instanceof Object?b(a[d],c[d]):a[d]!=c[d]&&(a[d]=c[d]):a[d]=c[d])}function c(a){return"FORM"==a.tagName?a:a.form}function d(a){return a[0].toUpperCase()+a.substr(1).toLowerCase()}function e(a){return a.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,function(a,b){return b.toUpperCase()})}function f(a,b){return null==a||a.matches(b)?a:f(a.parentElement,b)}var g=/*#__PURE__*/Object.freeze({__proto__:null,deepAssign:b,requestFromElement:function(a){return new Request(a.action||options.href||null,{method:a.method||null})},form:c,capitalize:d,camelCase:e,firstMatchingParentElement:f}),h=/*#__PURE__*/function(){function a(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this._options={triggerDelay:10},this._changes={},this._watchers=[],this._timer=null,this._privatize(),b(this,c);// Pre-init required by IE11
var d=function(a,b,c){var d=a[b];return window.Reflect&&window.Reflect.set&&Reflect.set(a,b,c),a._change(b,c,d),!0},e=function(a,b){if(b in a){var c=a[b];delete a[b],a._change(b,void 0,c)}return!0},f=null;try{f=new Proxy(this,{set:d,deleteProperty:e})}catch(a){f=new Proxy(this,{set:d})}return b(this,c),f}return _createClass(a,[{key:"clear",value:function clear(){for(var a in this)try{delete this[a]}catch(c){// Fallback for IE11
var b=this[a];this[a]=void 0,this._change(a,void 0,b)}return this}// Sync data object to model
},{key:"sync",value:function sync(a){return a=Object.assign({},a),b(this,a),this}// Add watcher callback
},{key:"watch",value:function watch(a){return this._watchers.push(a),this}},{key:"clearChanges",value:function clearChanges(){return this._changes={},this}},{key:"_privatize",value:function _privatize(){for(var a in this)"_"==a[0]&&Object.defineProperty(this,a,{enumerable:!1})}// Trigger all watcher callbacks
},{key:"_trigger",value:function _trigger(){if(window.clearTimeout(this._timer),this._timer=null,0<Object.keys(this._changes).length){var a=this._watchers;for(var b in a)a[b].call(this,this._changes);// Clear change list
this._changes={}}}// Log property change
},{key:"_change",value:function _change(a,b,c){var d=this;this._changes[a]={value:b,originalValue:c},this._timer||(this._timer=window.setTimeout(function(){return d._trigger()},this._options.triggerDelay))}}]),a}(),i=/*#__PURE__*/function(){function a(b,c,d){_classCallCheck(this,a),this.name=b,this.handler=c||function(a,b,c){return a(c)},this.model=d?d:new h,this.running=!1,k.autoCache&&a.cache(this)}// trigger before event and run the handler as a promise 
return _createClass(a,[{key:"run",value:function run(b){var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};k.verbose&&console.info("Action.run()",this.name,{action:this,target:b,data:d}),this.running=!0,b=b||document.body,d=Object.assign(d,a.data(b)),this.before(b,d);var e=null;if(this.handler instanceof Function)e=new Promise(function(a,b){return c.handler(a,b,d)});else if(this.handler instanceof Request){// If there is data to send, recreate the request with the data
if(0<Object.keys(d).length){var f={};for(var g in this.handler)f[g]=this.handler[g];if("POST"!=f.method)"GET"==f.method&&(// Append query string to URL with ?/& first as needed
f.url+=(0>f.url.indexOf("?")?"?":"&")+Object.keys(d).map(function(a){return a+"="+d[a]}).join("&"));else if("application/json"==b.attributes.enctype.value)f.body=JSON.stringify(d);else{var h=new FormData;for(var i in d)h.append(i,d[i]);f.body=h}this.handler=new Request(f.url,f)}e=fetch(this.handler).then(function(a){return a.json()})}return e.then(function(a){return c.after(b,!0,a,d)},function(a){return c.after(b,!1,a,d)})}},{key:"syncModel",value:function syncModel(a){return k.verbose&&console.info("Action.syncModel()",this.name,{action:this,data:a}),a instanceof Object||(a={result:a}),this.model.sync&&this.model.sync instanceof Function?this.model.sync(a):this.model instanceof Object&&b(this.model,a),a}},{key:"before",value:function before(b,c){k.verbose&&console.info("Action.before()",this.name,{action:this,target:b,data:c}),a.setCssClass(b,k.cssClass.loading),a.reflectCssClass(this.name,k.cssClass.loading),Object.assign(k.eventBefore.detail,{name:this.name,data:c,model:this.model}),b.dispatchEvent(k.eventBefore)}},{key:"after",value:function after(b,c,d,e){k.verbose&&console.info("Action.after()",this.name,{action:this,target:b,data:e,success:c,result:d}),this.running=!1;//target.removeAttribute('disabled')
var f=c?k.cssClass.success:k.cssClass.fail;return a.setCssClass(b,f),a.reflectCssClass(this.name,f),null!=d&&this.syncModel(d),Object.assign(k.eventAfter.detail,{name:this.name,success:c,data:e,model:this.model}),b.dispatchEvent(k.eventAfter),d}// #region Static methods
// Initialize the action cache and top-level event listener (only once)
}],[{key:"init",value:function init(){document.addEventListener("click",function(b){var c=f(b.target,"[ui-action]");if(c&&"FORM"!=c.tagName){var d=c.getAttribute("ui-action");// Don't run the action if it's already running
if(d in j)!1==j[d].running&&j[d].run(c);else if(k.autoCreate){// Auto create and run action
var e=a.createFromElement(c);a.cache(e),e.run(c)}else throw new Error("Action not found: "+d)}}),document.addEventListener("submit",function(b){if(b.target.matches("form[ui-action]")){b.preventDefault();var c=b.target.getAttribute("ui-action");// Don't run the action if it's already running
if(c in j)!1==j[c].running&&j[c].run(b.target);else if(k.autoCreate){// Auto create and run action
var d=a.createFromElement(b.target);a.cache(d),d.run(b.target)}else throw new Error("Action not found: "+c)}})}},{key:"create",value:function create(b){if(!1=="name"in b)throw"No action name specfied";return!1=="handler"in b&&(!0=="url"in b&&b.url?b.handler=new Request(b.url,b.request||{}):b.handler=null),new a(b.name,b.handler,b.model)}},{key:"createFromElement",value:function createFromElement(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return a.create(Object.assign({name:b.getAttribute("ui-action")||null,url:b.action||c.href||null,request:{method:b.method||null}},c))}// Cache an action 
},{key:"cache",value:function cache(b){return"string"==typeof b?j[b]:b.name in j?a:(j[b.name]=b,a)}},{key:"data",value:function(a){var b=a.dataset||{},d=c(a);return d&&(b=Object.assign(Object.fromEntries(new FormData(d)),b)),b}},{key:"get",value:function get(a){return j[a]}},{key:"setCssClass",value:function setCssClass(a,b){for(var c in k.cssClass)a.classList.remove(k.cssClass[c]);a.classList.add(b)}// Propagate class to all reflectors (ui-state and form submit buttons)
},{key:"reflectCssClass",value:function reflectCssClass(b,c){document.querySelectorAll("form[ui-action=\""+b+"\"] [type=\"submit\"], form[ui-action=\""+b+"\"] button:not([type]), [ui-state=\""+b+"\"]").forEach(function(b){return a.setCssClass(b,c)})}},{key:"options",get:function get(){return k},set:function set(a){b(k,a)}// #endregion
}]),a}(),j={},k={verbose:!1,autoCreate:!0,autoCache:!0,cssClass:{loading:"loading",success:"success",fail:"fail"},eventBefore:new CustomEvent("action.before",{bubbles:!0,detail:{type:"before",name:null,data:null,model:null}}),eventAfter:new CustomEvent("action.after",{bubbles:!0,detail:{type:"after",name:null,data:null,success:null,model:null}})};/**
     * Model
     * @description Observable data object
     */i.init();/**
     * Controller
     * Provider route mapping for SPAs
     */var l=/*#__PURE__*/function(){function a(b){_classCallCheck(this,a),this.view=b}return _createClass(a,[{key:"__autoload",value:function __autoload(){return this.view.render()}},{key:"__error",value:function __error(){return this.view.render()}},{key:"view",get:function get(){return this._view},set:function set(a){this._view=a}}]),a}(),m=/*#__PURE__*/function(a){function c(a,b){var d;// Accept an array of store keys
if(_classCallCheck(this,c),b instanceof Array){// Turn them into seperate stores
var e=b;for(var f in b=new h,e)b[e[f]]=new h}return b._paging={},d=_possibleConstructorReturn(this,_getPrototypeOf(c).call(this,b)),d.baseUrl=a,d}return _inherits(c,a),_createClass(c,[{key:"sync",value:function sync(a){if(!a.hasOwnProperty("data"))throw new Error("JsonApi: No data to sync");if(a.data instanceof Array){var e={};for(var f in a.data)e[a.data[f].id]=this.sync({data:a.data[f]});return e;//this[json.data[0].type]
}var c=a.data.type,d=a.data.id;return this[c]||(this[c]=new h),this[c][d]||(this[c][d]=new h),b(this[c][d],a.data),this[c][d]}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a,b){var c=this;if(this[a]){if(null!=b&&this[a][b])return Promise.resolve(this[a][b]);if(null==b)return Promise.resolve(this[a])}return fetch(this.baseUrl+"/"+a+(b?"/"+b:"")).then(function(a){return a.json()}).then(function(a){return c.sync(a)})})},{key:"page",value:function page(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(d=parseInt(d)||0,c=parseInt(c)||1,a in this._paging&&d in this._paging[a]&&c in this._paging[a][d])return Promise.resolve().then(function(){return b._paging[a][d][c]});a in this._paging||(this._paging[a]={}),d in this._paging[a]||(this._paging[a][d]={}),c in this._paging[a][d]||(this._paging[a][d][c]=new h({type:a,number:c,size:d,count:0,links:{},model:new h}));var e="?page[number]="+c;return 0<d&&(e+="&page[size]="+d),fetch(this.baseUrl+"/"+a+e).then(function(a){return a.json()}).then(function(e){return b._paging[a][d][c].sync({links:e.links||{},count:Object.keys(e.data).length,model:b.sync(e)})})}},{key:"post",value:function post(){/*
            data = {
                id: '1',
                attributes: {}
            }
            */}}]),c}(h),n=/*#__PURE__*/function(){function a(c){_classCallCheck(this,a),this.options={baseUrl:null,types:null,keys:{data:null,type:"type",id:"id"},per_page:0,query:{"page[number]":"page[number]","page[size]":"page[size]"},fetch:{method:"GET",headers:new Headers({"content-type":"application/json"}),mode:"no-cors"}},b(this.options,c||{});var d=new h;// Accept an array of store keys
if(d._paging={},this.options.types instanceof Array){var e={};// Turn them into seperate stores
for(var f in this.options.types)e[this.options.types[f]]=this.options.types[f];this.options.types=e}if(this.options.types instanceof Object)for(var g in this.options.types)d[this.options.types[g]]=new h;this._cache=new h(d)}return _createClass(a,[{key:"data",value:function data(a){return this.options.keys.data?a[this.options.keys.data]:a}},{key:"type",value:function(a){var b=a[this.options.keys.type];return this.options.types[b]&&(b=this.options.types[b]),b}},{key:"id",value:function id(a){return a[this.options.keys.id]}},{key:"sync",value:function sync(a){var c=this.data(a);if(!c)throw new Error("Store: No data to sync");if(c instanceof Array){var f={};for(var g in c){var i=null;this.options.keys.data?(i={},i[this.options.keys.data]=c[g]):i=c[g],f[this.id(c[g])]=this.sync(i)}return f}var d=this.type(c),e=this.id(c);return this._cache[d]||(this._cache[d]=new h),this._cache[d][e]||(this._cache[d][e]=new h),b(this._cache[d][e],c),this._cache[d][e]}},{key:"url",value:function(a){var b=this.options.types[a.type]||a.type,c=this.options.baseUrl+"/"+b+(a.id?"/"+a.id:""),d=[];for(var f in a)f in this.options.query?d.push(this.options.query[f]+"="+a[f]):"type"!=f&&"id"!=f&&d.push(f+"="+a[f]);var e=d.join("&");return e&&(c+="?"+e),c}},{key:"search",value:function search(a){var b=new h;for(var e in this._cache)if(!("_paging"==e||a.type&&this.type({type:a.type})!=e))for(var f in this._cache[e]){var c=!0,d=this.data(this._cache[e][f]);for(var g in a)if("type"!=g&&(!d.hasOwnProperty(g)||d[g]!=a[g])){c=!1;break}c&&(b[f]=d)}return b}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a,b){var c=this,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(a=this.type({type:a}),"object"==_typeof(b)&&(d=b,b=d.id),this._cache[a]){if(null!=b&&this._cache[a][b])return Promise.resolve(this._cache[a][b]);if(null==b&&0==Object.keys(d).length)return Promise.resolve(this._cache[a]);if(null==b){d.type=a;var f=this.search(d);if(Object.keys(f).length)return Promise.resolve(f)}}Object.assign(d,{type:a,id:b});var e=this.url(d);return fetch(e,this.options.fetch).then(function(a){return a.json()}).then(function(a){return c.sync(a)})})},{key:"page",value:function page(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;d=parseInt(d)||this.options.per_page,c=parseInt(c)||1;var e=this._cache._paging;if(a in e&&d in e[a]&&c in e[a][d])return Promise.resolve().then(function(){return e[a][d][c]});a in e||(e[a]={}),d in e[a]||(e[a][d]={}),c in e[a][d]||(e[a][d][c]=new h({type:a,number:c,size:d,count:0,links:{},model:new h}));var f=this.url({type:a,"page[number]":c,"page[size]":d});return fetch(f,this.options.fetch).then(function(a){return a.json()}).then(function(f){return e[a][d][c].sync({links:f.links||{},count:Object.keys(b.data(f)).length,model:b.sync(f)})})}},{key:"post",value:function post(a,b){var c=this,d=Object.create(this.options.fetch);d.method="POST",a=a||this.type(b);var e=this.url({type:a,id:this.id(b)});return fetch(e,d).then(function(a){return a.json()}).then(function(a){return c.sync(a)})}},{key:"patch",value:function patch(a,b){var c=this,d=Object.create(this.options.fetch);d.method="PATCH",a=a||this.type(b);var e=this.url({type:a,id:this.id(b)});return fetch(e,d).then(function(a){return a.json()}).then(function(a){return c.sync(a)})}},{key:"delete",value:function _delete(a,b){var c=this,d=Object.create(this.options.fetch);d.method="DELETE",a=a||this.type(data);var e=this.url({type:a,id:b});return fetch(e,d).then(function(){return delete c._cache[a][b]})}}]),a}(),o=/*#__PURE__*/function(a){function c(a){_classCallCheck(this,c);var d={keys:{data:"data",type:"type",id:"id"},query:{"page[number]":"page[number]","page[size]":"page[size]"},per_page:0};return b(d,a||{}),_possibleConstructorReturn(this,_getPrototypeOf(c).call(this,d))}return _inherits(c,a),c}(n),p=/*#__PURE__*/function(a){function c(a){_classCallCheck(this,c);var d={baseUrl:"/wp-json/wp/v2",types:{page:"pages",post:"posts",category:"categories",tag:"tags",comment:"comments"},keys:{data:null,type:"type",id:"id"},query:{"page[number]":"page","page[size]":"per_page"},per_page:10};return b(d,a||{}),_possibleConstructorReturn(this,_getPrototypeOf(c).call(this,d))}return _inherits(c,a),_createClass(c,[{key:"fetch",value:function fetch(a,b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return"string"==typeof b&&(d.slug=b,b=void 0),_get(_getPrototypeOf(c.prototype),"fetch",this).call(this,a,b,d)}}]),c}(n),q=/*#__PURE__*/function(){function a(b,c,d){var e=this;_classCallCheck(this,a),d instanceof h||(d=new h(d||{controller:null,data:{},dev:!1,error:null,method:null,path:null,view:null})),this._name=b,this._html=c,this._model=d,d.watch(function(a){return e.update(a)}),this.constructor.options.autoCache&&a.cache(this)}return _createClass(a,[{key:"clear",value:function clear(){return document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(a){a.innerHTML=""}),this}// When the model updates
},{key:"update",value:function update(a){this.constructor.options.verbose&&console.info(this.constructor.name+".update()",this.name,{view:this,changes:a}),this.render()}// Render the model data into the view template for all elements with [ui-view=this.name]
/**
         * Render view to all matching containers
         * @returns Promise
         */},{key:"render",value:function render(){var a=this;return this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this}),document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(b){b.innerHTML=a.html,a.renderSubviews(b)}),Object.assign(this.constructor.options.eventRender.detail,{view:this}),document.dispatchEvent(this.constructor.options.eventRender),Promise.resolve()}},{key:"renderSubviews",value:function renderSubviews(a){var b=this;this.constructor.options.verbose&&console.info(this.constructor.name+".renderSubviews()",this.name,{view:this,parent:a}),a.querySelectorAll("[ui-view]").forEach(function(a){var c=a.getAttribute("ui-view"),d=b.constructor.cache(c);d&&d.render()})}},{key:"name",get:function get(){return this._name}},{key:"html",get:function get(){return this._html instanceof Function?this._html(this._model):this._html},set:function set(a){this._html=a}},{key:"model",get:function get(){return this._model}// #region Static methods
// View factory
}],[{key:"create",value:function create(a){return this.options.verbose&&console.info(this.name+":create()",{options:a}),new this(a.name,a.html,a.model)}// Cache a view 
},{key:"cache",value:function cache(b){if(this.options.verbose&&console.info(this.name+":cache()",{view:b}),"string"==typeof b)return r[b];if(b instanceof a){if(b.name in r)throw"View name already exists: \""+b.name+"\"";return r[b.name]=b,this}return r}// Render all views
},{key:"options",get:function get(){return s},set:function set(a){b(s,a)}// #endregion
}]),a}(),r={},s={verbose:!1,autoCache:!0,// Automatically cache views when created
eventRender:new CustomEvent("view.render",{bubbles:!0,detail:{type:"render",view:null}})},t=/*#__PURE__*/function(a){function c(a,b,d){var e;return _classCallCheck(this,c),2==arguments.length&&(d=b,b=void 0),b||(b=a),e=_possibleConstructorReturn(this,_getPrototypeOf(c).call(this,a,null,d)),e.file=b,e}return _inherits(c,a),_createClass(c,[{key:"clear",value:function clear(){return this.html=null,_get(_getPrototypeOf(c.prototype),"clear",this).call(this)}},{key:"render",value:function render(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this});var b=null==this._html?this.fetch():Promise.resolve();return b.then(function(){return _get(_getPrototypeOf(c.prototype),"render",a).call(a)})}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(){var a=this;return this.constructor.options.verbose&&console.info(this.constructor.name+".fetch()",this.name,{view:this}),fetch(this.fullPath).then(function(a){if(a.ok)return a.text();throw new Error(a.statusText)}).then(function(b){return a._html=b}).catch(function(){throw new Error("File not found: "+a.fileName)})})},{key:"fileName",get:function get(){return this.file+"."+this.constructor.options.extension}},{key:"fullPath",get:function get(){return this.constructor.options.basePath+this.fileName}},{key:"file",get:function get(){return this._file},set:function set(a){a!=this._file&&(this._html=null),this._file=a}// #region Static methods
// View factory
}],[{key:"create",value:function create(a){return this.options.verbose&&console.info(this.name+":create()",{options:a}),a.file&&(a.file=a.name),new this(a.name,a.file,a.model)}},{key:"options",get:function get(){return u},set:function set(a){b(u,a)}// #endregion
}]),c}(q),u={basePath:"view/",extension:"html"};/**
     * JsonApi
     * @description Json API data store
     * @tutorial var store = new JsonApi('http://localhost:8080/api', ['category', 'product'])
     */t.options=q.options;/**
     * ViewHandlebars
     * @description View that uses Handlebars templates instead of html
     * @update Support for pre-compiled templates
     */var v=/*#__PURE__*/function(a){function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,_getPrototypeOf(c).apply(this,arguments))}return _inherits(c,a),_createClass(c,[{key:"render",value:function render(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this});var b=b=Promise.resolve();return null==this.html&&Handlebars.templates&&Handlebars.templates[this.file]&&(this.html=Handlebars.templates[this.file]),b.then(function(){return _get(_getPrototypeOf(c.prototype),"render",a).call(a)})}},{key:"fetch",value:function fetch(){var a=this;return _get(_getPrototypeOf(c.prototype),"fetch",this).call(this).then(function(b){return"templates"in Handlebars||(Handlebars.templates=[]),Handlebars.templates[a.file]=Handlebars.compile(b),a.html=Handlebars.templates[a.file],b})}// #region Static methods
}],[{key:"options",get:function get(){return w},set:function set(a){b(w,a)}// #endregion
}]),c}(t),w={};v.options=t.options,v.options.extension="hbs";var x=/*#__PURE__*/function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"start",value:function start(){window.addEventListener("popstate",this.onPopState.bind(this)),z.interceptLinks&&document.addEventListener("click",this.onClick.bind(this)),this.navigate(location.pathname)}},{key:"route",value:function route(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.options.routes[a]={route:a,callback:b,priority:c}}},{key:"match",value:function match(a){var b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];// Exact match
if(this.options.routes[a])return b&&"string"==typeof this.options.routes[a].callback?this.match(this.options.routes[a].callback):this.options.routes[a];var c=null;for(var d in Object.keys(this.options.routes))null!=a.match(d)&&(null==c||this.options.routes[d].priority<=c.priority)&&(c=this.options.routes[d]);// If route is a forward
return c&&b&&"string"==typeof c.callback&&(c=this.match(c.callback)),c}},{key:"navigate",value:function navigate(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;z.verbose&&console.info("Router.navigate()",{router:this,route:a,data:c});var f=this.sanitizePath(a),g=f[0],h=f[1],j=this.controllerName(g),k={data:c},m=this.match(a,!1);if(m&&"string"==typeof m.callback)// Redirect
return this.navigate(m.callback,c,d);this.controllers[j]||(g=z.defaultController,j=this.controllerName(g),h="/"==a?z.defaultMethod:f[0]),y[j]||(this.controllers[j]?y[j]=new this.controllers[j](this.view):y[j]=new l(this.view)),h=h||z.defaultMethod;var n=null,o=g+z.pathSeparator+h,p=e(h);y[j].view instanceof t?y[j].view.file=o:y[j].view instanceof v&&(y[j].view.html=o),z.autoload&&!(y[j][p]instanceof Function)&&(p=z.autoloadMethod),k.dev=location.host==z.devHost,k.view=o,k.controller=g,k.method=h,k.path=Array.from(f),k.event=d;// Query string to object
var q=location.search.substring(1);q&&(q=JSON.parse("{\""+decodeURI(q).replace(/"/g,"\\\"").replace(/&/g,"\",\"").replace(/=/g,"\":\"")+"\"}"),k.search=q);try{var r=Array.from(f);if(r.shift(),r.shift(),r.push(q),r.push(c),!m)y[j].view.model.clear().sync(k).clearChanges(),n=y[j][p].apply(y[j],r),this.pushState(a,{controller:g,method:h,data:Object.assign({},c),search:q});else if(m.callback instanceof i){m.callback.model.clear().sync(k).clearChanges();var s=d?d.target:document;n=m.callback.run(s,c)}else r.push(k),n=m.callback.apply(y[j],r)}catch(b){this.options.verbose&&console.error("Routing Error",b),this.pushState(a,{controller:g,method:h,data:Object.assign({},c),search:q}),n=this.handleError(j,k,f)}if(n instanceof Promise){var u=document.querySelectorAll("[ui-view=\""+this.view.name+"\"]");this.handleLoading(u,!0),n.then(function(){return b.handleLoading(u,!1)}).catch(function(a){throw b.handleLoading(u,!1),b.handleError(j,k,f,a),a})}return n}},{key:"handleLoading",value:function handleLoading(a,b){return b?a.forEach(function(a){return a.classList.add(z.cssClass.loading)}):a.forEach(function(a){return a.classList.remove(z.cssClass.loading)}),this}},{key:"handleError",value:function handleError(a,b,c,d){return b.error=d,b.view=b.controller+z.pathSeparator+z.errorView,b.path=c.join(z.pathSeparator),y[a].view instanceof t?y[a].view.file=(z.useControllerErrorViews?b.controller+z.pathSeparator:"")+z.errorView:y[a].view.html="Error loading "+b.path,y[a].view.model.clear().sync(b).clearChanges(),y[a][z.errorMethod]()}},{key:"sanitizePath",value:function sanitizePath(a){for(var b in z.verbose&&console.info("Router.sanitizePath()",{router:this,path:a}),"string"==typeof a&&(a=a.split("/"),a.shift(),a[0]=a[0]||z.defaultController),a)a[b]=(a[b]+"").toLowerCase();return 1==a.length&&a.push(z.defaultMethod),a}},{key:"controllerName",value:function controllerName(a){return z.verbose&&console.info("Router.controllerName()",{router:this,name:a}),d(e(a))+"Controller"}},{key:"pushState",value:function pushState(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};location.pathname!=a&&(c.route=a,b(this.state,c),history.pushState(this.state,null,a))}},{key:"onClick",value:function onClick(a){"A"==a.target.tagName&&a.target.pathname&&(a.preventDefault(),this.navigate(a.target.pathname,Object.assign({},a.target.dataset),a))}},{key:"onPopState",value:function onPopState(a){z.verbose&&console.info("Router.changeState()",{router:this,event:a});var b=location.pathname,c={};a.state&&(b=a.state.route,c=a.state.data),this.navigate(b,c)}// #region Properties
},{key:"controllers",get:function get(){return this.options.controllers},set:function set(a){this.options.controllers=a}},{key:"state",get:function get(){return this.options.state},set:function set(a){this.options.state=a}},{key:"view",get:function get(){return this.options.view instanceof q||(this.view=this.options.view),this.options.view},set:function set(a){this.options.view=a instanceof q?a:new t(a)}},{key:"options",get:function get(){return z},set:function set(a){b(z,a)}// #endregion
}]),a}(),y={},z={controllers:{},view:"controller",state:{},autoload:!0,verbose:!1,cssClass:{loading:"loading",success:"success",fail:"fail"},defaultController:"default",autoloadMethod:"__autoload",defaultMethod:"index",errorMethod:"__error",errorView:"error",useControllerErrorViews:!1,devHost:"localhost",interceptLinks:!0,pathSeparator:"/",routes:{}};return a.Action=i,a.Controller=l,a.JsonApi=m,a.Model=h,a.Router=x,a.Store=n,a.StoreJsonApi=o,a.StoreWordpress=p,a.Util=g,a.View=q,a.ViewFile=t,a.ViewHandlebars=v,a}({});