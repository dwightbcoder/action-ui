"use strict";function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=_superPropBase(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(3>arguments.length?a:c):e.value}},_get.apply(this,arguments)}function _superPropBase(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=_getPrototypeOf(a),null!==a););return a}function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _createForOfIteratorHelper(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=_unsupportedIterableToArray(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function n(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function e(a){throw a},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function s(){c=c.call(a)},n:function n(){var a=c.next();return g=a.done,a},e:function e(a){h=!0,f=a},f:function f(){try{g||null==c.return||c.return()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _createSuper(a){var b=_isNativeReflectConstruct();return function(){var c,d=_getPrototypeOf(a);if(b){var e=_getPrototypeOf(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _possibleConstructorReturn(a,b){if(b&&("object"===_typeof(b)||"function"==typeof b))return b;if(void 0!==b)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _wrapNativeSuper(a){var b="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(a){function c(){return _construct(a,arguments,_getPrototypeOf(this).constructor)}if(null===a||!_isNativeFunction(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(c,a)},_wrapNativeSuper(a)}function _construct(){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(b,c,d){var e=[null];e.push.apply(e,c);var a=Function.bind.apply(b,e),f=new a;return d&&_setPrototypeOf(f,d.prototype),f},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function _isNativeFunction(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var ActionUI=function(a){'use strict';/**
	 * Utilities
	 */ // Recursively copy source properties to target (Warning: Classes are treated as Objects)
function b(a,c){var d=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];for(var e in d&&(c=Object.assign(Array.isArray(c)?[]:{},c)),c)c.hasOwnProperty(e)&&(d&&c[e]instanceof Object&&(c[e]=Object.assign(Array.isArray(c[e])?[]:{},c[e])),a.hasOwnProperty(e)?(d&&a[e]instanceof Object&&(a[e]=Object.assign(Array.isArray(a[e])?[]:{},a[e])),a[e]instanceof Object&&c[e]instanceof Object&&!(a[e]instanceof Function||c[e]instanceof Function)?b(a[e],c[e]):a[e]!=c[e]&&(a[e]=c[e])):a[e]=c[e],Array.isArray(a[e])&&Array.isArray(c[e])&&0==c[e].length&&0!=a[e].length&&(a[e]=[]));return a;// For simpler dereference usage
}function c(a,c){return b(a,c,!0)}function d(a){return"FORM"==a.tagName?a:a.form}function e(a){return a[0].toUpperCase()+a.substr(1).toLowerCase()}function f(a){return a.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,function(a,b){return b.toUpperCase()})}function g(a,b){return null==a||a.matches(b)?a:g(a.parentElement,b)}function h(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return c=Object.assign(Object.fromEntries(new FormData(a)),c),Object.entries(c).map(function(a){var d=a[0].split("[").map(function(a){return a.replace(/]/g,"")});if(1<d.length){var e=i(d,a[1]);b(c,e),delete c[a[0]]}return a}),c}function i(a,b,c){var d=a.pop();if(!d)return c;var e={};return e[d]=c?c:b,i(a,b,e)}var j=/*#__PURE__*/Object.freeze({__proto__:null,deepAssign:b,deepCopy:c,requestFromElement:function(a){return new Request(a.action||options.href||null,{method:a.method||null})},form:d,capitalize:e,camelCase:f,firstMatchingParentElement:g,formToObject:h}),k=/*#__PURE__*/function(){//static __instance = 0
function a(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,a),this._options={triggerDelay:10},this._changes={},this._watchers=[],this._timer=null,this._parent=d,b(this,c),this._privatize(),this.sync(c);var f=function(b,c,d){var e=b[c];if(b[c]&&b[c]instanceof a)b[c].sync(d);else if(window.Reflect&&window.Reflect.set)!(d instanceof Object)||Array.isArray(d)||d instanceof a||"_"==c[0]||(d=new a(d,{model:b,property:c})),Reflect.set(b,c,d);else throw"Missing Model dependency: Reflect.set()";return"_"==c[0]||(b._change(c,d,e),!0)},g=function(a,b){if(b in a){var c=a[b];delete a[b],a._change(b,void 0,c)}return!0},h=null;try{h=new Proxy(this,{set:f,deleteProperty:g})}catch(a){h=new Proxy(this,{set:f})}return b(this,c),h}return _createClass(a,[{key:"clear",value:function clear(){for(var a in this)try{delete this[a]}catch(c){// Fallback for IE11
var b=this[a];this[a]=void 0,this._change(a,void 0,b)}return this}// Sync data object to model
},{key:"sync",value:function sync(a){return a=b({},a,!0),b(this,a),this}// Add watcher callback
},{key:"watch",value:function watch(a){return this._watchers.push(a),this}},{key:"clearChanges",value:function clearChanges(){return this._changes={},this}},{key:"triggerChanges",value:function triggerChanges(){return this._trigger(!0)}},{key:"_privatize",value:function _privatize(){for(var a in this)"_"==a[0]&&Object.defineProperty(this,a,{enumerable:!1})}// Trigger all watcher callbacks
},{key:"_trigger",value:function _trigger(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];if(window.clearTimeout(this._timer),this._timer=null,a||0<Object.keys(this._changes).length){var b=this._watchers;for(var c in b)b[c].call(this,this._changes);// Clear change list
this._changes={}}}// Log property change
},{key:"_change",value:function _change(a,c,d){var e=this;if(this._changes[a]={value:c,originalValue:d},this._timer||(this._timer=window.setTimeout(function(){return e._trigger()},this._options.triggerDelay)),null!=this._parent){var f={};f=b({},this,!0),f[a]=d,this._parent.model._change(this._parent.property,this,f)}}}]),a}(),l=/*#__PURE__*/function(){function a(b,c,d){_classCallCheck(this,a),this.name=b,this.handler=c||function(a,b,c){return a(c)},this.model=d?d:new k,this.running=!1,o.autoCache&&a.cache(this)}// trigger before event and run the handler as a promise 
return _createClass(a,[{key:"run",value:function run(b){var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};o.verbose&&console.info("Action.run()",this.name,{action:this,target:b,data:d}),this.running=!0,b=b||document.body,d=Object.assign(d,a.data(b));var e=!this.before(b,d),f=null;if(e)f=Promise.reject(new m("Canceled"));else if(this.handler instanceof Function)f=new Promise(function(a,b){return c.handler(a,b,d)});else if(this.handler instanceof Request){// If there is data to send, recreate the request with the data
if(0<Object.keys(d).length){var g={};for(var h in this.handler)g[h]=this.handler[h];if("POST"!=g.method)"GET"==g.method&&(// Append query string to URL with ?/& first as needed
g.url+=(0>g.url.indexOf("?")?"?":"&")+Object.keys(d).map(function(a){return a+"="+d[a]}).join("&"));else if(b.attributes.enctype&&"application/json"==b.attributes.enctype.value)g.body=JSON.stringify(d);else{var i=new FormData;for(var j in d)i.append(j,d[j]);g.body=i}this.handler=new Request(g.url,g)}f=fetch(this.handler).then(function(a){return a.json().then(function(b){return a.ok?b:Promise.reject(b)})})}return f.then(function(a){return c.after(b,!0,a,d)},function(a){return c.after(b,!1,a,d)})}},{key:"syncModel",value:function syncModel(a){return a=b({},a,!0),o.verbose&&console.info("Action.syncModel()",this.name,{action:this,data:a}),a instanceof Object||(a={result:a}),this.model.sync&&this.model.sync instanceof Function?this.model.sync(a):this.model instanceof Object&&b(this.model,a),a}},{key:"before",value:function before(b,c){o.verbose&&console.info("Action.before()",this.name,{action:this,target:b,data:c}),a.setCssClass(b,o.cssClass.loading),a.reflectCssClass(this.name,o.cssClass.loading);var d=new CustomEvent(o.eventBefore.type,o.eventBefore);return Object.assign(d.detail,{name:this.name,data:c,model:this.model}),b.dispatchEvent(d)}},{key:"after",value:function after(b,c,d,e){o.verbose&&console.info("Action.after()",this.name,{action:this,target:b,data:e,success:c,result:d}),this.running=!1;var f=d instanceof m,g=c?o.cssClass.success:o.cssClass.fail;f&&(g=o.cssClass.canceled),a.setCssClass(b,g),a.reflectCssClass(this.name,g),null==d||d instanceof Error||this.syncModel(d);var h=new CustomEvent(o.eventAfter.type,o.eventAfter);return Object.assign(h.detail,{name:this.name,success:c,data:e,model:this.model,error:!!(d instanceof Error)&&d,canceled:f}),b.dispatchEvent(h),d}// #region Static methods
// Initialize the action cache and top-level event listener (only once)
}],[{key:"init",value:function init(){document.addEventListener("click",function(b){var c=g(b.target,"[ui-action]");if(c&&"FORM"!=c.tagName){"INPUT"==c.tagName&&("checkbox"==c.type||"radio"==c.type)||b.preventDefault();var d=c.getAttribute("ui-action");// Don't run the action if it's already running
if(d in n)!1==n[d].running&&n[d].run(c);else if(o.autoCreate){// Auto create and run action
var e=a.createFromElement(c);a.cache(e),e.run(c)}else throw new Error("Action not found: "+d)}}),document.addEventListener("submit",function(b){if(b.target.matches("form[ui-action]")){b.preventDefault();var c=b.target.getAttribute("ui-action");// Don't run the action if it's already running
if(c in n)!1==n[c].running&&n[c].run(b.target);else if(o.autoCreate){// Auto create and run action
var d=a.createFromElement(b.target);a.cache(d),d.run(b.target)}else throw new Error("Action not found: "+c)}})}},{key:"create",value:function create(b){if(!1=="name"in b)throw"No action name specfied";return!1=="handler"in b&&(!0=="url"in b&&b.url?b.handler=new Request(b.url,b.request||{}):b.handler=null),new a(b.name,b.handler,b.model)}},{key:"createFromElement",value:function createFromElement(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return a.create(Object.assign({name:b.getAttribute("ui-action")||null,url:b.action||b.href||c.href||null,request:{method:b.method||c.method||"GET"}},c))}// Cache an action 
},{key:"cache",value:function cache(a){return null==a?n:"string"==typeof a?n[a]:a.name in n?this:(n[a.name]=a,this)}},{key:"data",value:function(a){var b=a.dataset||{},c=d(a);return c&&(b=h(c,b)),b}},{key:"get",value:function get(a){return n[a]}},{key:"setCssClass",value:function setCssClass(a,b){for(var c in o.cssClass)a.classList.remove(o.cssClass[c]);a.classList.add(b)}// Propagate class to all reflectors (ui-state and form submit buttons)
},{key:"reflectCssClass",value:function reflectCssClass(b,c){document.querySelectorAll("form[ui-action=\""+b+"\"] [type=\"submit\"], form[ui-action=\""+b+"\"] button:not([type]), [ui-state=\""+b+"\"]").forEach(function(b){return a.setCssClass(b,c)})}},{key:"options",get:function get(){return o},set:function set(a){b(o,a)}// #endregion
}]),a}(),m=/*#__PURE__*/function(a){function b(){return _classCallCheck(this,b),c.apply(this,arguments)}_inherits(b,a);var c=_createSuper(b);return b}(/*#__PURE__*/_wrapNativeSuper(Error)),n={},o={verbose:!1,autoCreate:!0,autoCache:!0,cssClass:{loading:"loading",success:"success",fail:"fail",canceled:"canceled"},eventBefore:new CustomEvent("action.before",{bubbles:!0,cancelable:!0,detail:{type:"before",name:null,data:null,model:null}}),eventAfter:new CustomEvent("action.after",{bubbles:!0,cancelable:!0,detail:{type:"after",name:null,data:null,success:null,model:null}})};/**
	 * Model
	 * @description Observable data object
	 */l.init();/**
	 * Controller
	 * Provider route mapping for SPAs
	 */var p=/*#__PURE__*/function(){function a(b){_classCallCheck(this,a),this.view=b}return _createClass(a,[{key:"__autoload",value:function __autoload(){return this.view.render()}},{key:"__error",value:function __error(){return this.view.render()}},{key:"view",get:function get(){return this._view},set:function set(a){this._view=a}}]),a}(),q=/*#__PURE__*/function(a){function c(a,b){var e;// Accept an array of store keys
if(_classCallCheck(this,c),b instanceof Array){// Turn them into seperate stores
var f=b;for(var g in b=new k,f)b[f[g]]=new k}return b._paging={},e=d.call(this,b),e.baseUrl=a,e}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"sync",value:function sync(a){if(!a.hasOwnProperty("data"))throw new Error("JsonApi: No data to sync");if(a.data instanceof Array){var e={};for(var f in a.data)e[a.data[f].id]=this.sync({data:a.data[f]});return e;//this[json.data[0].type]
}var c=a.data.type,d=a.data.id;return this[c]||(this[c]=new k),this[c][d]||(this[c][d]=new k),b(this[c][d],a.data),this[c][d]}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a,b){var c=this;if(this[a]){if(null!=b&&this[a][b])return Promise.resolve(this[a][b]);if(null==b)return Promise.resolve(this[a])}return fetch(this.baseUrl+"/"+a+(b?"/"+b:"")).then(function(a){return a.json()}).then(function(a){return c.sync(a)})})},{key:"page",value:function page(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(d=parseInt(d)||0,c=parseInt(c)||1,a in this._paging&&d in this._paging[a]&&c in this._paging[a][d])return Promise.resolve().then(function(){return b._paging[a][d][c]});a in this._paging||(this._paging[a]={}),d in this._paging[a]||(this._paging[a][d]={}),c in this._paging[a][d]||(this._paging[a][d][c]=new k({type:a,number:c,size:d,count:0,links:{},model:new k}));var e="?page[number]="+c;return 0<d&&(e+="&page[size]="+d),fetch(this.baseUrl+"/"+a+e).then(function(a){return a.json()}).then(function(e){return b._paging[a][d][c].sync({links:e.links||{},count:Object.keys(e.data).length,model:b.sync(e)})})}},{key:"post",value:function post(){/*
	        data = {
	            id: '1',
	            attributes: {}
	        }
	        */}}]),c}(k),r=/*#__PURE__*/function(){function a(c){// Accept an array of store keys
if(_classCallCheck(this,a),this.options={baseUrl:null,types:null,keys:{data:null,type:"type",id:"id"},keysExcludeFromCache:[],per_page:0,query:{"page[number]":"page[number]","page[size]":"page[size]"},fetch:{method:"GET",headers:{"Content-Type":"application/json"},mode:"no-cors"},searchDepth:1,triggerChangesOnError:!0,// Allows views to update contents on failed requests, especially useful for Fetch All requests which return no results or 404
triggerChangesOnEmpty:!0,verbose:!1,viewClass:null,viewMap:{},actionVerb:{get:"fetch",post:"create",patch:"update",delete:"delete"},actionHandler:{get:this.actionHandler,post:this.actionHandler,patch:this.actionHandler,delete:this.actionHandler},eventBefore:new CustomEvent("store.before",{bubbles:!0,cancelable:!0,detail:{type:"before",name:null,fetch:null,data:null,model:null,view:null}}),eventAfter:new CustomEvent("store.after",{bubbles:!0,detail:{type:"after",name:null,fetch:null,data:null,model:null,view:null,success:null,response:null}})},b(this.options,c||{}),this._model=new k,this._urlCache={},this._model._paging={},this.options.types instanceof Array){var d={};// Turn them into seperate stores
for(var e in this.options.types)d[this.options.types[e]]=this.options.types[e];this.options.types=d}if(this.options.types instanceof Object)for(var f in this.options.types)this.modelCreate(this.options.types[f]);a.cache(this)}return _createClass(a,[{key:"body",value:function body(a,b){return JSON.stringify(b)}},{key:"model",value:function model(a,b){return b?this._model[a][b]:this._model[a]}},{key:"modelCreate",value:function modelCreate(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("string"!=typeof a)throw new Error("Store: Cannot create model without `type`");this._model[a]||(this._model[a]=new k({_type:a,_loading:!1},{model:this._model,property:a}),this.actionCreate(a,"get"),this.actionCreate(a,"post"),this.actionCreate(a,"patch"),this.actionCreate(a,"delete"),this.options.viewClass&&this.options.viewMap.hasOwnProperty(a)&&new this.options.viewClass(this.options.viewMap[a],this._model[a])),null==b||"string"!=typeof b&&"number"!=typeof b||this._model[a][b]||(this._model[a][b]=new k({_type:a},{model:this._model[a],property:b}))}},{key:"actionCreate",value:function actionCreate(a,b){b=b.toLowerCase();var c=a+" "+this.options.actionVerb[b],d=this.options.actionHandler[b].bind(this,a,b),e=new l(c,d);return l.cache(e),e}},{key:"actionHandler",value:function actionHandler(a,b,c,d,e){var f=null;return"get"===b?f=this.fetch(a,e.id):"post"===b?f=this.post(a,e):"patch"===b?f=this.patch(a,e):"delete"===b?f=this.delete(a,e.id):void 0,f.then(function(a){return c(a)}).catch(function(a){return d(a)})}},{key:"data",value:function data(a){return this.options.keys.data?a[this.options.keys.data]:a}},{key:"type",value:function(a){var b=a[this.options.keys.type];return this.options.types[b]&&(b=this.options.types[b]),b}},{key:"id",value:function id(a){return a[this.options.keys.id]}},{key:"sync",value:function sync(a,b){var c=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],d=this.data(a);if(!d||0==Object.keys(d).length)throw new Error("Store: No data to sync");if(d instanceof Array){var g={};for(var h in d){var i=null;this.options.keys.data?(i={},i[this.options.keys.data]=d[h]):i=d[h],g[this.id(d[h])]=this.sync(i,b)}return c||this.syncPaging(a,b),g}var e=this.type(d),f=this.id(d);if(this._model[e]||this.modelCreate(e),this._model[e][f]||this.modelCreate(e,f),!this._model[e][f])throw new Error("Store: No model for type: "+e+", id: "+f);return this._model[e][f].sync(d),b&&(!this._model[e][f].hasOwnProperty("_store")&&(this._model[e][f]._store={url:[]}),-1==this._model[e][f]._store.url.indexOf(b)&&this._model[e][f]._store.url.push(b),b=this.url({type:e,id:f}),-1==this._model[e][f]._store.url.indexOf(b)&&this._model[e][f]._store.url.push(b)),this._model[e][f]}},{key:"syncPaging",value:function syncPaging(a,b){var d=this.pageData(b);// Paging
if(d.type&&d.pageSize&&d.pageNumber){var j=this.data(a);if(Array.isArray(j)){var e,f=this.model(d.type),g=[],h=c({},d),i=_createForOfIteratorHelper(j);try{for(i.s();!(e=i.n()).done;){var l=e.value;g.push({id:l[this.options.keys.id],type:l[this.options.keys.type]})}}catch(a){i.e(a)}finally{i.f()}h.data=g,h.url=[b],f._paging||(f._paging=new k({current:null,type:d.type,pageNumber:d.pageNumber,pageSize:d.pageSize},{model:f,property:"_paging"})),f._paging[d.pageSize]||(f._paging[d.pageSize]=new k({},{model:f._paging,property:d.pageSize})),f._paging[d.pageSize][d.pageNumber]||(f._paging[d.pageSize][d.pageNumber]=new k({},{model:f._paging[d.pageSize],property:d.pageNumber})),f._paging[d.pageSize][d.pageNumber].sync(h)}return this.pageChange(d.type,d.pageNumber,d.pageSize)}}},{key:"url",value:function(a){var b=this.options.types[a.type]||a.type,c=this.options.baseUrl+"/"+b+"/"+(a.id?a.id+"/":""),d=new URLSearchParams;for(var f in a)f in this.options.query?d.set(this.options.query[f],a[f]):"type"!=f&&"id"!=f&&d.set(f,a[f]);d.sort();var e=d.toString();return e&&(c+="?"+e),c}},{key:"urlParse",value:function urlParse(a){if(!a)return{url:null,type:null,pageNumber:!1,pageSize:!1};-1==a.indexOf("://")&&(0<a.indexOf("/")&&(a="/"+a),a=location.origin+a);var b=new URL(a),c=b.pathname.replace(this.options.baseUrl,"").split("/"),d=c[0]||c[1];return b.searchParams.sort(),{url:b,type:d,pageNumber:parseInt(b.searchParams.get(this.options.query["page[number]"])),pageSize:parseInt(b.searchParams.get(this.options.query["page[size]"]))}}},{key:"search",value:function search(a){var b=new k;for(var e in this._model)if(!(0==e.indexOf("_")||a.type&&this.type({type:a.type})!=e))for(var f in this._model[e]){var c=!1,d=this._model[e][f];for(var g in a)c=this.propertyValueExists(d,g,a[g],this.options.searchDepth);c&&(b[f]=d)}return b}},{key:"propertyValueExists",value:function propertyValueExists(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,e=Object.keys(a);if(-1<e.indexOf(b))return a[b]==c;if(1>=d)return!1;for(var f,g=0,h=e;g<h.length;g++)if(f=h[g],"object"==_typeof(a[f]))return this.propertyValueExists(a[f],b,c,d-1)}},{key:"fetch",value:function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function c(a,b){var d,e,f=arguments;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return d=2<f.length&&void 0!==f[2]?f[2]:{},a=this.type({type:a}),d=d||{},b=b||void 0,"object"==_typeof(b)&&(d=b,b=d.id),e=this.url(Object.assign({},d,{type:a,id:b})),this.options.verbose&&console.info("Store.fetch()",a,b,{type:a,id:b,query:d,store:this,url:e,options:this.options.fetch}),c.abrupt("return",this.fetchUrl(e,a,d));case 8:case"end":return c.stop();}},c,this)}));return function fetch(){return a.apply(this,arguments)}}()},{key:"fetchUrl",value:function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function c(a,b){var d,e,f,g,h,i,j=arguments;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(d=2<j.length&&void 0!==j[2]?j[2]:{},a){c.next=3;break}return c.abrupt("return",Promise.reject());case 3:if(c.prev=3,d=d||{},d.type=b,e=this.urlParse(a).url.toString(),f=this.urlCache(e),b=d.type||(f?f.type:null)||e.type||null,!f){c.next=12;break}return this.pageChange(f.type,f.pageNumber,f.pageSize),c.abrupt("return",Promise.resolve(f.model));case 12:return this.before(b,this.options.fetch,d),c.next=15,fetch(a,this.options.fetch);case 15:return g=c.sent,this.after(b,this.options.fetch,d,!!g&&g.ok,g),c.next=19,g.json();case 19:if(h=c.sent,g.ok){c.next=23;break}return b&&this.options.triggerChangesOnError&&this._model[b]&&this.model(b).triggerChanges(),c.abrupt("return",Promise.reject(h));case 23:return c.prev=23,i=this.sync(h,a),this.urlCache(e,i,h),c.abrupt("return",i);case 29:return c.prev=29,c.t0=c["catch"](23),b&&this.options.triggerChangesOnError&&this._model[b]&&this.model(b).triggerChanges(),c.abrupt("return",Promise.reject(h));case 33:c.next=41;break;case 35:return c.prev=35,c.t1=c["catch"](3),b&&this.options.triggerChangesOnError&&this._model[b]&&this.model(b).triggerChanges(),c.next=40,Promise.reject(c.t1);case 40:return c.abrupt("return",c.sent);case 41:case"end":return c.stop();}},c,this,[[3,35],[23,29]])}));return function fetchUrl(){return a.apply(this,arguments)}}()},{key:"urlCache",value:function urlCache(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(a=decodeURIComponent(a),!b&&!c)return this._urlCache[a];var d=this.pageData(a),e=b[this.options.keys.type]||b._type||(d?d.type:null);if(c){var f,g=_createForOfIteratorHelper(this.options.keysExcludeFromCache);try{for(g.s();!(f=g.n()).done;){var h=f.value;delete c[h]}}catch(a){g.e(a)}finally{g.f()}}return this._urlCache[a]={url:a,type:e,model:b,json:c,pageNumber:!!d&&d.pageNumber,pageSize:!!d&&d.pageSize}}},{key:"pageData",value:function pageData(a){if(!a)return{type:null,pageNumber:!1,pageSize:!1};var b=this.urlParse(a),c=this._urlCache[a];return{type:b.type||(c?c.type:null),pageNumber:b.pageNumber||!!c&&c.pageNumber,pageSize:b.pageSize||!!c&&c.pageSize}}},{key:"paging",value:function paging(a){return this.model(a)._paging||{current:!1,pageNumber:!1,pageSize:!1}}},{key:"page",value:function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function b(a){var c,d,e,f=arguments;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c=1<f.length&&void 0!==f[1]?f[1]:1,d=2<f.length&&void 0!==f[2]?f[2]:0,e=3<f.length&&void 0!==f[3]?f[3]:{},e=e||{},d=parseInt(d)||this.options.per_page,c=parseInt(c)||1,e.type=a,e[this.options.query["page[number]"]]=c,e[this.options.query["page[size]"]]=d,b.next=11,this.fetch(a,0,e);case 11:return b.abrupt("return",b.sent);case 12:case"end":return b.stop();}},b,this)}));return function page(){return a.apply(this,arguments)}}()},{key:"pageChange",value:function pageChange(a,b,c){return!!(a&&this._model[a]._paging&&this._model[a]._paging[c][b])&&(this._model[a]._paging.pageNumber=b,this._model[a]._paging.pageSize=c,delete this._model[a]._paging.current,this._model[a]._paging.current=this._model[a]._paging[c][b],this._model[a]._paging)}},{key:"post",value:function post(a,b){var c=this;a=a||this.type(b);var d=this.url({type:a,id:this.id(b)}),e=Object.create(this.options.fetch);return e.method="POST",e.body=this.body(a,b),this.options.verbose&&console.info("Store.post()",a,{type:a,data:b,store:this,url:d,options:e}),fetch(d,e).then(function(a){return a.json().then(function(b){return a.ok?b:Promise.reject(b)})}).then(function(a){return c.sync(a,d)}).catch(function(b){return c.options.triggerChangesOnError&&c.model(a).triggerChanges(),Promise.reject(b)})}},{key:"patch",value:function patch(a,b){var d=this;a=a||this.type(b);var e=this.url({type:a,id:this.id(b)}),f={};return c(f,this.options.fetch),f.method="PATCH",f.body=this.body(a,b),this.options.verbose&&console.info("Store.patch()",a,{type:a,data:b,store:this,url:e,options:f}),fetch(e,f).then(function(a){return a.json().then(function(b){return a.ok?b:Promise.reject(b)})}).then(function(a){return d.sync(a,e)}).catch(function(b){return d.options.triggerChangesOnError&&d.model(a).triggerChanges(),Promise.reject(b)})}},{key:"delete",value:function _delete(a,b){var c=this,d=Object.create(this.options.fetch);d.method="DELETE";var e=this.url({type:a,id:b});return this.options.verbose&&console.info("Store.delete()",a,b,{type:a,id:b,store:this,url:e,options:d}),fetch(e,d).then(function(a){return a.json().then(function(b){return a.ok?b:Promise.reject(b)})}).then(function(d){return delete c._model[a][b],d}).catch(function(b){return c.options.triggerChangesOnError&&c.model(a).triggerChanges(),Promise.reject(b)})}},{key:"loading",value:function loading(a,b){this._model[a]||this.modelCreate(a);var c=this.model(a);return 1==arguments.length?c._loading:void(c._loading=!!b)}},{key:"before",value:function before(a,b,c){var d=this,e=this.options.baseUrl+"/"+a,f=null;this.loading(a,!0),this.options.viewClass&&this.options.viewMap.hasOwnProperty(a)&&(f=this.options.viewClass.cache(this.options.viewMap[a])),this.options.verbose&&console.info("Store.before()",e,{store:this,type:a,fetch:b,data:c,view:f,model:this.model(a)}),f&&document.querySelectorAll("[ui-view=\""+f.name+"\"]").forEach(function(a){d.options.viewClass.setCssClass(a,d.options.viewClass.options.cssClass.loading)});var g=new CustomEvent(this.options.eventBefore.type,this.options.eventBefore);return Object.assign(g.detail,{name:e,fetch:b,store:this,data:c,model:this.model(a),view:f}),document.dispatchEvent(g)}},{key:"after",value:function after(a,b,c,d,e){var f=this,g=this.options.baseUrl+"/"+a,h=null;this.loading(a,!1),this.options.viewClass&&this.options.viewMap.hasOwnProperty(a)&&(h=this.options.viewClass.cache(this.options.viewMap[a])),this.options.verbose&&console.info("Store.after()",g,{store:this,type:a,fetch:b,data:c,view:h,model:this.model(a),success:d,response:e}),h&&document.querySelectorAll("[ui-view=\""+h.name+"\"]").forEach(function(a){f.options.viewClass.setCssClass(a,d?f.options.viewClass.options.cssClass.success:f.options.viewClass.options.cssClass.fail)});var i=new CustomEvent(this.options.eventAfter.type,this.options.eventAfter);return Object.assign(i.detail,{name:g,success:d,fetch:b,store:this,data:c,model:this.model(a),view:h,response:e}),document.dispatchEvent(i)}}],[{key:"cache",value:function cache(a){if(null==a)return s;if("string"==typeof a){if(a=a.toLowerCase(),null!=s[a])return s[a];// Find a store that starts with the requested url to match ('/api/v1/entity' with a '/api/v1' store)
for(var b in s)if(b.startsWith(a))return s[b];return}var c=a.options.baseUrl.toLowerCase();return c in s?this:(s[c]=a,this)}}]),a}(),s={},t=/*#__PURE__*/function(a){function c(a){_classCallCheck(this,c);var e={keys:{data:"data",type:"type",id:"id",links:"links",meta:"meta",included:"included"},keysExcludeFromCache:["data","included"],query:{"page[number]":"page[number]","page[size]":"page[size]"},per_page:0,fetch:{headers:{"Content-Type":"application/vnd.api+json"}},searchDepth:2};return b(e,a||{}),d.call(this,e)}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"sync",value:function sync(a,b){var d=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];if(a[this.options.keys.included]){var e=this.options.keys.data;this.options.keys.data=this.options.keys.included,_get(_getPrototypeOf(c.prototype),"sync",this).call(this,a,b,!0),this.options.keys.data=e}return _get(_getPrototypeOf(c.prototype),"sync",this).call(this,a,b,d)}},{key:"syncPaging",value:function syncPaging(a,b){var d=_get(_getPrototypeOf(c.prototype),"syncPaging",this).call(this,a,b);return d&&d.current&&(d.current[this.options.keys.links]=a[this.options.keys.links],d.current[this.options.keys.meta]=a[this.options.keys.meta]),d}},{key:"body",value:function body(a,d){var e=d.id?d.id:this.id(d),f={};return f[this.options.keys.data]={},f[this.options.keys.data][this.options.keys.type]=a,f[this.options.keys.data].attributes={},e&&(f[this.options.keys.data][this.options.keys.id]=e),d[this.options.keys.data]?b(f[this.options.keys.data],d[this.options.keys.data]):d.attributes?b(f[this.options.keys.data],d):b(f[this.options.keys.data].attributes,d),f[this.options.keys.data].attributes[this.options.keys.type]&&delete f[this.options.keys.data].attributes[this.options.keys.type],f[this.options.keys.data].attributes[this.options.keys.id]&&delete f[this.options.keys.data].attributes[this.options.keys.id],_get(_getPrototypeOf(c.prototype),"body",this).call(this,a,f)}}]),c}(r),u=/*#__PURE__*/function(a){function c(a){_classCallCheck(this,c);var e={baseUrl:"/wp-json/wp/v2",types:{page:"pages",post:"posts",category:"categories",tag:"tags",comment:"comments"},keys:{data:null,type:"type",id:"id"},query:{"page[number]":"page","page[size]":"per_page"},per_page:10};return b(e,a||{}),d.call(this,e)}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"fetch",value:function fetch(a,b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return"string"==typeof b&&(d.slug=b,b=void 0),_get(_getPrototypeOf(c.prototype),"fetch",this).call(this,a,b,d)}}]),c}(r),v=/*#__PURE__*/function(){function a(b,c,d){var e=this;_classCallCheck(this,a),d instanceof k||(d=new k(d||{controller:null,data:{},dev:!1,error:null,method:null,path:null,view:null})),this._name=b,this._html=c,this._model=d,d.watch(function(a){return e.update(a)}),this.constructor.options.autoCache&&a.cache(this)}return _createClass(a,[{key:"clear",value:function clear(){return document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(a){a.innerHTML=""}),this}// When the model updates
},{key:"update",value:function update(a){this.constructor.options.verbose&&console.info(this.constructor.name+".update()",this.name,{view:this,changes:a}),this.render()}// Render the model data into the view template for all elements with [ui-view=this.name]
/**
	     * Render view to all matching containers
	     * @returns Promise
	     */},{key:"render",value:function render(){var a=this;return this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this}),Object.assign(this.constructor.options.eventRender.detail,{name:this.model.view,view:this}),document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(b){b.innerHTML=a.html,b.dispatchEvent(a.constructor.options.eventRender),a.renderSubviews(b)}),Promise.resolve()}},{key:"renderSubviews",value:function renderSubviews(a){var b=this;this.constructor.options.verbose&&console.info(this.constructor.name+".renderSubviews()",this.name,{view:this,parent:a}),a.querySelectorAll("[ui-view]").forEach(function(a){var c=a.getAttribute("ui-view"),d=b.constructor.cache(c);d&&d.render()})}},{key:"name",get:function get(){return this._name}},{key:"html",get:function get(){return this._html instanceof Function?this._html(this._model):this._html},set:function set(a){this._html=a}},{key:"model",get:function get(){return this._model}// #region Static methods
// View factory
}],[{key:"create",value:function create(a){return this.options.verbose&&console.info(this.name+":create()",{options:a}),new this(a.name,a.html,a.model)}// Cache a view 
},{key:"cache",value:function cache(b){if(this.options.verbose&&console.info(this.name+":cache()",{view:b}),"string"==typeof b)return w[b];if(b instanceof a){if(b.name in w)throw"View name already exists: \""+b.name+"\"";return w[b.name]=b,this}return w}// Render all views
},{key:"options",get:function get(){return x},set:function set(a){b(x,a)}// #endregion
}]),a}(),w={},x={verbose:!1,autoCache:!0,// Automatically cache views when created
eventRender:new CustomEvent("view.render",{bubbles:!0,detail:{type:"render",name:null,view:null}})},y=/*#__PURE__*/function(a){function c(a,b,e){var f;return _classCallCheck(this,c),2==arguments.length&&(e=b,b=void 0),b||(b=a),f=d.call(this,a,null,e),f.file=b,f}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"clear",value:function clear(){return this.html=null,_get(_getPrototypeOf(c.prototype),"clear",this).call(this)}},{key:"render",value:function render(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this});var b=null==this._html?this.fetch():Promise.resolve();return b.then(function(){return _get(_getPrototypeOf(c.prototype),"render",a).call(a)})}},{key:"fetch",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(){var a=this;return this.constructor.options.verbose&&console.info(this.constructor.name+".fetch()",this.name,{view:this}),this.fetchBefore(),fetch(this.fullPath).then(function(a){if(a.ok)return a.text();throw new Error(a.statusText)}).then(function(b){return a._html=b,a.fetchAfter(!0),a._html}).catch(function(){throw a.fetchAfter(!1),new Error("File not found: "+a.fileName)})})},{key:"fetchBefore",value:function fetchBefore(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".fetchBefore()",this.name,{view:this}),document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(b){a.constructor.setCssClass(b,z.cssClass.loading)}),this.constructor.options.eventFetch&&(Object.assign(this.constructor.options.eventFetch.detail,{view:this,success:null}),document.dispatchEvent(this.constructor.options.eventFetch))}},{key:"fetchAfter",value:function fetchAfter(a){var b=this;this.constructor.options.verbose&&console.info(this.constructor.name+".fetchAfter()",this.name,{view:this}),document.querySelectorAll("[ui-view=\""+this._name+"\"]").forEach(function(c){b.constructor.setCssClass(c,a?z.cssClass.success:z.cssClass.fail)}),this.constructor.options.eventFetch&&(Object.assign(this.constructor.options.eventFetch.detail,{view:this,success:a}),document.dispatchEvent(this.constructor.options.eventFetch))}},{key:"fileName",get:function get(){return this.file+"."+this.constructor.options.extension}},{key:"fullPath",get:function get(){return this.constructor.options.basePath+this.fileName}},{key:"file",get:function get(){return this._file},set:function set(a){a!=this._file&&(this._html=null),this._file=a}// #region Static methods
// View factory
}],[{key:"create",value:function create(a){return this.options.verbose&&console.info(this.name+":create()",{options:a}),a.file&&(a.file=a.name),new this(a.name,a.file,a.model)}},{key:"setCssClass",value:function setCssClass(a,b){for(var c in z.cssClass)a.classList.remove(z.cssClass[c]);a.classList.add(b)}},{key:"options",get:function get(){return z},set:function set(a){b(z,a)}// #endregion
}]),c}(v),z={basePath:"view/",extension:"html",cssClass:{loading:"loading",success:"success",fail:"fail"},eventFetch:new CustomEvent("view.fetch",{bubbles:!0,detail:{type:"fetch",view:null,success:null}}),eventRender:new CustomEvent("view.render",{bubbles:!0,detail:{type:"render",view:null}})};/**
	 * JsonApi
	 * @description Json API data store
	 * @tutorial var store = new JsonApi('http://localhost:8080/api', ['category', 'product'])
	 */y.options=v.options;/**
	 * ViewHandlebars
	 * @description View that uses Handlebars templates instead of html
	 * @update Support for pre-compiled templates
	 */var A=/*#__PURE__*/function(a){function c(){return _classCallCheck(this,c),d.apply(this,arguments)}_inherits(c,a);var d=_createSuper(c);return _createClass(c,[{key:"render",value:function render(){var a=this;this.constructor.options.verbose&&console.info(this.constructor.name+".render()",this.name,{view:this});var b=Promise.resolve();return null==this.html&&Handlebars.templates&&Handlebars.templates[this.file]&&(this.html=Handlebars.templates[this.file]),b.then(function(){return _get(_getPrototypeOf(c.prototype),"render",a).call(a)})}},{key:"fetch",value:function fetch(){var a=this;return _get(_getPrototypeOf(c.prototype),"fetch",this).call(this).then(function(b){return"templates"in Handlebars||(Handlebars.templates=[]),Handlebars.templates[a.file]=Handlebars.compile(b),a.html=Handlebars.templates[a.file],b})}// #region Static methods
}],[{key:"options",get:function get(){return B},set:function set(a){b(B,a)}// #endregion
}]),c}(y),B={};A.options=y.options,A.options.extension="hbs";var C=/*#__PURE__*/function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"start",value:function start(){window.addEventListener("popstate",this.onPopState.bind(this)),E.interceptLinks&&document.addEventListener("click",this.onClick.bind(this)),this.navigate(location.pathname)}},{key:"route",value:function route(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.options.routes[a]={route:a,callback:b,priority:c}}},{key:"match",value:function match(a){var b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];// Exact match
if(this.options.routes[a])return b&&"string"==typeof this.options.routes[a].callback?this.match(this.options.routes[a].callback):this.options.routes[a];var c=null;for(var d in Object.keys(this.options.routes))null!=a.match(d)&&(null==c||this.options.routes[d].priority<=c.priority)&&(c=this.options.routes[d]);// If route is a forward
return c&&b&&"string"==typeof c.callback&&(c=this.match(c.callback)),c}},{key:"navigate",value:function navigate(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;E.verbose&&console.info("Router.navigate()",{router:this,route:a,data:c});var g=this.sanitizePath(a),h=g[0],i=g[1],j=this.controllerName(h),k={data:c},m=this.match(a,!1);if(m&&"string"==typeof m.callback)// Redirect
return this.navigate(m.callback,c,d);this.controllers[j]||(h=E.defaultController,j=this.controllerName(h),i="/"==a?E.defaultMethod:g[0]),D[j]||(this.controllers[j]?D[j]=new this.controllers[j](this.view):D[j]=new p(this.view)),i=i||E.defaultMethod;var n=null,o=h+E.pathSeparator+i,q=f(i);D[j].view instanceof y?D[j].view.file=o:D[j].view instanceof A&&(D[j].view.html=o),E.autoload&&!(D[j][q]instanceof Function)&&(q=E.autoloadMethod),k.dev=location.host==E.devHost,k.view=o,k.controller=h,k.method=i,k.path=Array.from(g),k.event=d;// Query string to object
var r=location.search.substring(1);r&&(r=JSON.parse("{\""+decodeURI(r).replace(/"/g,"\\\"").replace(/&/g,"\",\"").replace(/=/g,"\":\"")+"\"}"),k.search=r);try{var s=Array.from(g);if(s.shift(),s.shift(),s.push(r),s.push(c),!m)D[j].view.model.clear().sync(k).clearChanges(),n=D[j][q].apply(D[j],s),this.pushState(a,{controller:h,method:i,data:Object.assign({},c),search:r});else if(m.callback instanceof l){m.callback.model.clear().sync(k).clearChanges();var t=d?d.target:document;n=m.callback.run(t,c)}else s.push(k),n=m.callback.apply(D[j],s)}catch(b){this.options.verbose&&console.error("Routing Error",b),this.pushState(a,{controller:h,method:i,data:Object.assign({},c),search:r}),n=this.handleError(j,k,g)}if(n instanceof Promise){var u=document.querySelectorAll("[ui-view=\""+this.view.name+"\"]");this.handleLoading(u,!0),n.then(function(){return b.handleLoading(u,!1)}).catch(function(a){throw b.handleLoading(u,!1),b.handleError(j,k,g,a),a})}return n}},{key:"handleLoading",value:function handleLoading(a,b){return b?a.forEach(function(a){return a.classList.add(E.cssClass.loading)}):a.forEach(function(a){return a.classList.remove(E.cssClass.loading)}),this}},{key:"handleError",value:function handleError(a,b,c,d){return b.error=d,b.view=b.controller+E.pathSeparator+E.errorView,b.path=c.join(E.pathSeparator),D[a].view instanceof y?D[a].view.file=(E.useControllerErrorViews?b.controller+E.pathSeparator:"")+E.errorView:D[a].view.html="Error loading "+b.path,D[a].view.model.clear().sync(b).clearChanges(),D[a][E.errorMethod]()}},{key:"sanitizePath",value:function sanitizePath(a){for(var b in E.verbose&&console.info("Router.sanitizePath()",{router:this,path:a}),"string"==typeof a&&(a=a.split("/"),a.shift(),a[0]=a[0]||E.defaultController),a)a[b]=(a[b]+"").toLowerCase();return 1==a.length&&a.push(E.defaultMethod),a}},{key:"controllerName",value:function controllerName(a){return E.verbose&&console.info("Router.controllerName()",{router:this,name:a}),e(f(a))+"Controller"}},{key:"pushState",value:function pushState(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};location.pathname!=a&&(c.route=a,b(this.state,c),history.pushState(this.state,null,a))}},{key:"onClick",value:function onClick(a){"A"==a.target.tagName&&a.target.pathname&&(a.preventDefault(),this.navigate(a.target.pathname,Object.assign({},a.target.dataset),a))}},{key:"onPopState",value:function onPopState(a){E.verbose&&console.info("Router.changeState()",{router:this,event:a});var b=location.pathname,c={};a.state&&(b=a.state.route,c=a.state.data),this.navigate(b,c)}// #region Properties
},{key:"controllers",get:function get(){return this.options.controllers},set:function set(a){this.options.controllers=a}},{key:"state",get:function get(){return this.options.state},set:function set(a){this.options.state=a}},{key:"view",get:function get(){return this.options.view instanceof v||(this.view=this.options.view),this.options.view},set:function set(a){this.options.view=a instanceof v?a:new y(a)}},{key:"options",get:function get(){return E},set:function set(a){b(E,a)}// #endregion
}]),a}(),D={},E={controllers:{},view:"controller",state:{},autoload:!0,verbose:!1,cssClass:{loading:"loading",success:"success",fail:"fail"},defaultController:"default",autoloadMethod:"__autoload",defaultMethod:"index",errorMethod:"__error",errorView:"error",useControllerErrorViews:!1,devHost:"localhost",interceptLinks:!0,pathSeparator:"/",routes:{}};return a.Action=l,a.ActionErrorCanceled=m,a.Controller=p,a.JsonApi=q,a.Model=k,a.Router=C,a.Store=r,a.StoreJsonApi=t,a.StoreWordpress=u,a.Util=j,a.View=v,a.ViewFile=y,a.ViewHandlebars=A,a}({});